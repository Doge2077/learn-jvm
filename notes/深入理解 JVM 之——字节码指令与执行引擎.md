# ç±»æ–‡ä»¶ç»“æ„

****

## Write Onceï¼ŒRun Anywhere
****

å¯¹äº `C` è¯­è¨€ä»ç¨‹åºåˆ°è¿è¡Œéœ€è¦ç»è¿‡ç¼–è¯‘çš„è¿‡ç¨‹ï¼Œåªæœ‰ç»å†äº†ç¼–è¯‘åï¼Œæˆ‘ä»¬æ‰€ç¼–å†™çš„ä»£ç æ‰èƒ½å¤Ÿç¿»è¯‘ä¸ºæœºå™¨å¯ä»¥ç›´æ¥è¿è¡Œçš„äºŒè¿›åˆ¶ä»£ç ï¼Œå¹¶ä¸”åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸‹ï¼Œæˆ‘ä»¬çš„ä»£ç éƒ½éœ€è¦è¿›è¡Œä¸€æ¬¡ç¼–è¯‘ä¹‹åæ‰èƒ½è¿è¡Œã€‚

è€Œ `Java` ä¸åŒäº `C`ï¼Œç”±äº `JVM` å†…ç½®äº†è§£é‡Šå™¨å’Œå³æ—¶ç¼–è¯‘å™¨ï¼Œè¿™ä½¿å¾— `.java` å¯ä»¥ä¸ç»è¿‡ç¼–è¯‘å°±ç›´æ¥é€šè¿‡è§£é‡Šçš„æ–¹å¼ç›´æ¥è¿è¡Œã€‚å…³äºè§£é‡Šå™¨å’Œå³æ—¶ç¼–è¯‘å™¨çš„å†…å®¹æˆ‘ä»¬å°†åœ¨ä»¥åä»‹ç»ã€‚

æˆ‘ä»¬æ¥çœ‹ä¸€æ®µç®€å•çš„ä»£ç ï¼š

```java
public class Hello {
    public static void main(String[] args) {
        System.out.println("Hello world");
    }
}
```

æˆ‘ä»¬å°†å…¶ä¿å­˜ä¸º `Hello.java`ï¼Œç„¶åè¿è¡Œï¼š

```shell
java Hello.java
```

å¯ä»¥çœ‹åˆ°ä¸å‡ºæ„å¤–åœ°è¾“å‡ºäº†ï¼š

![image-20230905163020567](https://image.itbaima.net/images/40/image-20230905167713407.png)

è¿™æ ·æˆ‘ä»¬å°±é€šè¿‡è§£é‡Šçš„æ–¹å¼è¿è¡Œäº†åˆšåˆšç¼–å†™çš„ `.java` æ–‡ä»¶ï¼Œä½†ä¸ºäº†æ›´å¥½çš„ç†è§£ `Java` çš„ç±»æ–‡ä»¶ç»“æ„ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å¯¹ `.java` æ–‡ä»¶è¿›è¡Œç¼–è¯‘ï¼š

```shell
javac Hello.java
```

å¯ä»¥çœ‹åˆ°åœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆäº†ä¸€ä¸ª `Hello.class` æ–‡ä»¶ï¼š

![image-20230905163351158](https://image.itbaima.net/images/40/image-20230905164213676.png)

æ¥ä¸‹æ¥æˆ‘ä»¬è¿è¡Œï¼š

```shell
java Hello
```

å¯ä»¥çœ‹åˆ°ä¸å‡ºæ„å¤–çš„è¾“å‡ºäº†ï¼š

![image-20230905163722881](https://image.itbaima.net/images/40/image-20230905163889038.png)

è¿™æ ·æˆ‘ä»¬å°±ä»¥è¿è¡Œç¼–è¯‘åçš„æ–‡ä»¶æ–¹å¼è¿è¡Œäº† `.class` æ–‡ä»¶ã€‚

å¦‚æœæˆ‘ä»¬ä»¥åå…­è¿›åˆ¶æ‰“å¼€è¯¥æ–‡ä»¶ï¼š

![image-20230905163517473](https://image.itbaima.net/images/40/image-20230905165686984.png)

ä½ ä¼šçœ‹åˆ°ä¸Šè¿°æ–‡ä»¶å……æ»¡äº†ä»¥ä¸¤ä¸ªå­—èŠ‚ä¸ºä¸€ç»„çš„å­—èŠ‚ç ï¼Œå‰ä¸¤ç»„å››ä¸ªå­—èŠ‚è¢«æˆä¸ºâ€œé­”æ•°â€ï¼Œè¯´æ˜è¯¥æ–‡ä»¶æ˜¯å¦ä¸ºä¸€ä¸ªèƒ½è¢«è™šæ‹Ÿæœºæ¥å—çš„ `Class` æ–‡ä»¶ï¼Œè€Œ `Java` çš„ `Class` æ–‡ä»¶çš„é­”æ•°å€¼ä¸º `0xCAFEBABE` â˜•ğŸ‘¶ã€‚

â€œä¸€æ¬¡ç¼–å†™ï¼Œåˆ°å¤„è¿è¡Œâ€â€”â€”è¿™æ˜¯ `Java` åœ¨åˆšåˆšè¯ç”Ÿä¹‹æ—¶æå‡ºçš„éå¸¸è‘—åçš„å®£ä¼ å£å·ï¼Œè€Œ `Java` çš„è§£å†³æ–¹æ¡ˆä¾¿æ˜¯å°†åƒä¸Šé¢è¿™æ ·çš„æºä»£ç ç¼–è¯‘ä¸ºå¹³å°æ— å…³çš„ä¸­é—´æ ¼å¼â€”â€”å­—èŠ‚ç æ–‡ä»¶ï¼ˆ`.class`  æ–‡ä»¶ï¼‰ï¼Œå¹¶é€šè¿‡å¯¹åº”çš„ `Java` è™šæ‹Ÿæœºè¯»å–å’Œè¿è¡Œè¿™äº›ä¸­é—´æ ¼å¼çš„ç¼–è¯‘æ–‡ä»¶ï¼Œè¿™å°±ä½¿å¾—è¯­è¨€æœ¬èº«å®ç°äº†è·¨å¹³å°ã€‚

****

## ç±»æ–‡ä»¶ç»“æ„æ¦‚è¿°

****

`Java` æºä»£ç ç»è¿‡ç¼–è¯‘å™¨ç¼–è¯‘åä¼šç”Ÿæˆç±»ä¼¼ä¸Šé¢çš„å­—èŠ‚ç æ–‡ä»¶ï¼ˆ`.class` æ–‡ä»¶ï¼‰ï¼Œå…¶ä¸­å­—èŠ‚ç æ–‡ä»¶çš„ç»“æ„å¦‚ä¸‹ï¼š

1. é­”æ•°ï¼ˆMagic Numberï¼‰ï¼šå­—èŠ‚ç æ–‡ä»¶çš„å‰å››ä¸ªå­—èŠ‚æ˜¯ä¸€ä¸ªå›ºå®šçš„é­”æ•°ï¼ˆ`0xCAFEBABE`ï¼‰ï¼Œç”¨äºæ ‡è¯†è¯¥æ–‡ä»¶ä¸º `Java` å­—èŠ‚ç æ–‡ä»¶ã€‚

2. ç‰ˆæœ¬ä¿¡æ¯ï¼ˆVersionï¼‰ï¼šç´§éšé­”æ•°ä¹‹åçš„ä¸¤ä¸ªå­—èŠ‚è¡¨ç¤ºå­—èŠ‚ç æ–‡ä»¶çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œåˆ†åˆ«æ˜¯ä¸»ç‰ˆæœ¬å·å’Œæ¬¡ç‰ˆæœ¬å·ã€‚

3. å¸¸é‡æ± ï¼ˆConstant Poolï¼‰ï¼šç´§éšç‰ˆæœ¬ä¿¡æ¯ä¹‹åæ˜¯ä¸€ä¸ªå¸¸é‡æ± è¡¨ï¼ˆConstant Pool Tableï¼‰ï¼Œç”¨äºå­˜å‚¨ç¼–è¯‘æ—¶ç”Ÿæˆçš„å„ç§å¸¸é‡ã€ç¬¦å·å¼•ç”¨å’Œå­—é¢é‡ã€‚å¸¸é‡æ± ä¸­çš„æ¯ä¸ªé¡¹ç›®éƒ½æœ‰ä¸€ä¸ªç´¢å¼•ï¼Œé€šè¿‡ç´¢å¼•å¯ä»¥åœ¨è¿è¡Œæ—¶æŸ¥æ‰¾å’Œä½¿ç”¨ã€‚

4. è®¿é—®æ ‡å¿—ï¼ˆAccess Flagsï¼‰ï¼šç´§éšå¸¸é‡æ± ä¹‹åçš„ä¸¤ä¸ªå­—èŠ‚è¡¨ç¤ºç±»æˆ–æ¥å£çš„è®¿é—®æ ‡å¿—ï¼Œç”¨äºæŒ‡ç¤ºè¯¥ç±»æˆ–æ¥å£çš„è®¿é—®çº§åˆ«å’Œç‰¹æ€§ã€‚

5. ç±»ç´¢å¼•ã€çˆ¶ç±»ç´¢å¼•å’Œæ¥å£ç´¢å¼•ï¼ˆClass Indexesï¼‰ï¼šç´§éšè®¿é—®æ ‡å¿—ä¹‹åçš„ä¸¤ä¸ªå­—èŠ‚è¡¨ç¤ºç±»ç´¢å¼•ï¼Œç”¨äºæŒ‡å‘å¸¸é‡æ± ä¸­è¯¥ç±»çš„å…¨é™å®šåã€‚æ¥ç€æ˜¯ä¸¤ä¸ªå­—èŠ‚çš„çˆ¶ç±»ç´¢å¼•ï¼Œç”¨äºæŒ‡å‘å¸¸é‡æ± ä¸­çˆ¶ç±»çš„å…¨é™å®šåã€‚æ¥å£ç´¢å¼•è¡¨ç´§éšçˆ¶ç±»ç´¢å¼•ä¹‹åï¼Œç”¨äºæŒ‡å‘å¸¸é‡æ± ä¸­å®ç°çš„æ¥å£çš„å…¨é™å®šåã€‚

6. å­—æ®µè¡¨ï¼ˆField Tableï¼‰ï¼šç´§éšæ¥å£ç´¢å¼•ä¹‹åæ˜¯å­—æ®µè¡¨ï¼Œç”¨äºæè¿°ç±»æˆ–æ¥å£ä¸­å®šä¹‰çš„å­—æ®µçš„è®¿é—®æ ‡å¿—ã€å­—æ®µåã€å­—æ®µç±»å‹ç­‰ä¿¡æ¯ã€‚

7. æ–¹æ³•è¡¨ï¼ˆMethod Tableï¼‰ï¼šç´§éšå­—æ®µè¡¨ä¹‹åæ˜¯æ–¹æ³•è¡¨ï¼Œç”¨äºæè¿°ç±»æˆ–æ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•çš„è®¿é—®æ ‡å¿—ã€æ–¹æ³•åã€æ–¹æ³•å‚æ•°ã€æ–¹æ³•è¿”å›ç±»å‹ç­‰ä¿¡æ¯ã€‚

8. å±æ€§è¡¨ï¼ˆAttribute Tableï¼‰ï¼šç´§éšæ–¹æ³•è¡¨ä¹‹åæ˜¯å±æ€§è¡¨ï¼Œç”¨äºå­˜å‚¨ä¸ç±»ã€å­—æ®µæˆ–æ–¹æ³•ç›¸å…³çš„é™„åŠ ä¿¡æ¯ï¼Œå¦‚æ³¨è§£ã€ä»£ç è¡Œå·è¡¨ã€å¼‚å¸¸è¡¨ç­‰ã€‚

****

# å­—èŠ‚ç æŒ‡ä»¤

****

## ç”Ÿæˆåç¼–è¯‘æ–‡ä»¶

****

ç”±äºå­—èŠ‚ç å®åœ¨~~ä¸æ˜¯äººè¯»çš„~~éš¾ä»¥ç†è§£ï¼Œå¦‚æœä½ æ„Ÿå…´è¶£å…¨éƒ¨è¯»æ‡‚å¯ä»¥è‡ªè¡Œæ·±å…¥å­¦ä¹ ï¼ˆ ~~çœŸçš„æœ‰äººç”¨çº¯å­—èŠ‚ç ç¼–ç¨‹å—~~ï¼Œæˆ‘ä»¬è¿˜æ˜¯åº·åº·èƒ½ç†è§£ä¸€ç‚¹çš„ä¸œè¥¿ç½¢ï¼‰

æˆ‘ä»¬åˆ©ç”¨ `javap` å‘½ä»¤å¯¹ `.class` æ–‡ä»¶åç¼–è¯‘ï¼Œå°†å…¶è¾“å‡ºåˆ°æ–‡æœ¬ï¼š

```shell
javap -v Hello.class > Hello.txt
```

> `javap` å‘½ä»¤çš„ä¸€äº›å¸¸ç”¨é€‰é¡¹åŒ…æ‹¬ï¼š
>
> - `-c`ï¼šæ˜¾ç¤ºå­—èŠ‚ç æŒ‡ä»¤ã€‚
> - `-l`ï¼šæ˜¾ç¤ºè¡Œå·å’Œæœ¬åœ°å˜é‡è¡¨ã€‚
> - `-s`ï¼šæ˜¾ç¤ºå†…éƒ¨ç±»å‹ç­¾åã€‚
> - `-verbose`ï¼šæ˜¾ç¤ºæ‰€æœ‰ä¿¡æ¯ï¼Œå¯ç®€åŒ–ä¸º `-v`ã€‚

ç„¶åæ‰“å¼€ `Hello.txt` æŸ¥çœ‹ï¼š

```java
Classfile /L:/JAVA/BasicSyntax/Learn_JVM/code/Hello.class
  Last modified 2023å¹´9æœˆ5æ—¥; size 415 bytes
  SHA-256 checksum 35b1e377d78c81fc0a324af427c3e67c3a468b293c544de8715343f4d97c0c52
  Compiled from "Hello.java"
public class Hello
  minor version: 0
  major version: 61
  flags: (0x0021) ACC_PUBLIC, ACC_SUPER
  this_class: #21                         // Hello
  super_class: #2                         // java/lang/Object
  interfaces: 0, fields: 0, methods: 2, attributes: 1
Constant pool:
   #1 = Methodref          #2.#3          // java/lang/Object."<init>":()V
   #2 = Class              #4             // java/lang/Object
   #3 = NameAndType        #5:#6          // "<init>":()V
   #4 = Utf8               java/lang/Object
   #5 = Utf8               <init>
   #6 = Utf8               ()V
   #7 = Fieldref           #8.#9          // java/lang/System.out:Ljava/io/PrintStream;
   #8 = Class              #10            // java/lang/System
   #9 = NameAndType        #11:#12        // out:Ljava/io/PrintStream;
  #10 = Utf8               java/lang/System
  #11 = Utf8               out
  #12 = Utf8               Ljava/io/PrintStream;
  #13 = String             #14            // Hello world
  #14 = Utf8               Hello world
  #15 = Methodref          #16.#17        // java/io/PrintStream.println:(Ljava/lang/String;)V
  #16 = Class              #18            // java/io/PrintStream
  #17 = NameAndType        #19:#20        // println:(Ljava/lang/String;)V
  #18 = Utf8               java/io/PrintStream
  #19 = Utf8               println
  #20 = Utf8               (Ljava/lang/String;)V
  #21 = Class              #22            // Hello
  #22 = Utf8               Hello
  #23 = Utf8               Code
  #24 = Utf8               LineNumberTable
  #25 = Utf8               main
  #26 = Utf8               ([Ljava/lang/String;)V
  #27 = Utf8               SourceFile
  #28 = Utf8               Hello.java
{
  public Hello();
    descriptor: ()V
    flags: (0x0001) ACC_PUBLIC
    Code:
      stack=1, locals=1, args_size=1
         0: aload_0
         1: invokespecial #1                  // Method java/lang/Object."<init>":()V
         4: return
      LineNumberTable:
        line 1: 0

  public static void main(java.lang.String[]);
    descriptor: ([Ljava/lang/String;)V
    flags: (0x0009) ACC_PUBLIC, ACC_STATIC
    Code:
      stack=2, locals=1, args_size=1
         0: getstatic     #7                  // Field java/lang/System.out:Ljava/io/PrintStream;
         3: ldc           #13                 // String Hello world
         5: invokevirtual #15                 // Method java/io/PrintStream.println:(Ljava/lang/String;)V
         8: return
      LineNumberTable:
        line 3: 0
        line 4: 8
}
SourceFile: "Hello.java"
```

ä¸Šè¿°æ–‡ä»¶å†…å®¹å°±æ˜¯åˆ©ç”¨ `javap` åæ±‡ç¼–å¾—åˆ°çš„å…¨éƒ¨ä¿¡æ¯ï¼Œè¿™å®é™…ä¸Šæ˜¯å› ä¸º `Class` æ–‡ä»¶é‡‡ç”¨äº†ä¸€ç§ç±»ä¼¼äº `C` ä¸­ç»“æ„ä½“çš„ä¼ªç»“æ„æ¥å­˜å‚¨æ•°æ®ã€‚

****

## å¸¸è§å­—èŠ‚ç æŒ‡ä»¤

****

âš å¤§é‡å®šä¹‰è­¦å‘Šâš ï¼šä»¥ä¸‹å°†å‡ºç°å¤§é‡æŒ‡ä»¤ï¼Œç”¨åˆ°æŸ¥è¡¨å³å¯ï¼Œå»ºè®®ç®€å•äº†è§£åŠ è½½å’Œå­˜å‚¨æŒ‡ä»¤å’ŒåŸºæœ¬çš„è¿ç®—æŒ‡ä»¤å³å¯ï¼Œé‡ç‚¹æ”¾åœ¨å­¦ä¹ æœ€åçš„æ–¹æ³•è°ƒç”¨æŒ‡ä»¤å®ç°é‡å†™å’Œé‡è½½çš„ç»†èŠ‚ï¼ˆé‡ä¸­ä¹‹é‡ï¼‰ã€‚

****

### åŠ è½½å’Œå­˜å‚¨æŒ‡ä»¤

****

åŠ è½½å’Œå­˜å‚¨æŒ‡ä»¤ç”¨äºå°†æ•°æ®åœ¨æ ˆå¸§ä¸­çš„å±€éƒ¨å˜é‡è¡¨å’Œæ“ä½œæ•°æ ˆä¹‹é—´æ¥å›ä¼ è¾“ï¼š

1. å±€éƒ¨å˜é‡åŠ è½½æŒ‡ä»¤ï¼ˆLoad Instructionsï¼‰ï¼š
   - `iload`: ä»å±€éƒ¨å˜é‡è¡¨åŠ è½½ä¸€ä¸ªintç±»å‹çš„å˜é‡åˆ°æ“ä½œæ ˆã€‚
   - `lload`: ä»å±€éƒ¨å˜é‡è¡¨åŠ è½½ä¸€ä¸ªlongç±»å‹çš„å˜é‡åˆ°æ“ä½œæ ˆã€‚
   - `fload`: ä»å±€éƒ¨å˜é‡è¡¨åŠ è½½ä¸€ä¸ªfloatç±»å‹çš„å˜é‡åˆ°æ“ä½œæ ˆã€‚
   - `dload`: ä»å±€éƒ¨å˜é‡è¡¨åŠ è½½ä¸€ä¸ªdoubleç±»å‹çš„å˜é‡åˆ°æ“ä½œæ ˆã€‚
   - `aload`: ä»å±€éƒ¨å˜é‡è¡¨åŠ è½½ä¸€ä¸ªå¼•ç”¨ç±»å‹çš„å˜é‡åˆ°æ“ä½œæ ˆã€‚

2. å±€éƒ¨å˜é‡å­˜å‚¨æŒ‡ä»¤ï¼ˆStore Instructionsï¼‰ï¼š
   - `istore`: å°†ä¸€ä¸ªintç±»å‹çš„æ•°å€¼ä»æ“ä½œæ•°æ ˆå­˜å‚¨åˆ°å±€éƒ¨å˜é‡è¡¨ã€‚
   - `lstore`: å°†ä¸€ä¸ªlongç±»å‹çš„æ•°å€¼ä»æ“ä½œæ•°æ ˆå­˜å‚¨åˆ°å±€éƒ¨å˜é‡è¡¨ã€‚
   - `fstore`: å°†ä¸€ä¸ªfloatç±»å‹çš„æ•°å€¼ä»æ“ä½œæ•°æ ˆå­˜å‚¨åˆ°å±€éƒ¨å˜é‡è¡¨ã€‚
   - `dstore`: å°†ä¸€ä¸ªdoubleç±»å‹çš„æ•°å€¼ä»æ“ä½œæ•°æ ˆå­˜å‚¨åˆ°å±€éƒ¨å˜é‡è¡¨ã€‚
   - `astore`: å°†ä¸€ä¸ªå¼•ç”¨ç±»å‹çš„æ•°å€¼ä»æ“ä½œæ•°æ ˆå­˜å‚¨åˆ°å±€éƒ¨å˜é‡è¡¨ã€‚

3. å¸¸é‡åŠ è½½æŒ‡ä»¤ï¼ˆConstant Instructionsï¼‰ï¼š
   - `iconst`: å°†intç±»å‹çš„å¸¸é‡åŠ è½½åˆ°æ“ä½œæ•°æ ˆã€‚
   - `lconst`: å°†longç±»å‹çš„å¸¸é‡åŠ è½½åˆ°æ“ä½œæ•°æ ˆã€‚
   - `fconst`: å°†floatç±»å‹çš„å¸¸é‡åŠ è½½åˆ°æ“ä½œæ•°æ ˆã€‚
   - `dconst`: å°†doubleç±»å‹çš„å¸¸é‡åŠ è½½åˆ°æ“ä½œæ•°æ ˆã€‚
   - `aconst_null`: å°†nullå¼•ç”¨åŠ è½½åˆ°æ“ä½œæ•°æ ˆã€‚

4. æ“ä½œæ•°æ ˆæŒ‡ä»¤ï¼ˆStack Instructionsï¼‰ï¼š
   - `bipush`: å°†ä¸€ä¸ªå­—èŠ‚å¤§å°çš„å¸¸é‡åŠ è½½åˆ°æ“ä½œæ•°æ ˆã€‚
   - `sipush`: å°†ä¸€ä¸ªçŸ­æ•´å‹å¤§å°çš„å¸¸é‡åŠ è½½åˆ°æ“ä½œæ•°æ ˆã€‚

****

### è¿ç®—ç›¸å…³æŒ‡ä»¤

****

1. åŠ æ³•æŒ‡ä»¤ï¼ˆAddition Instructionsï¼‰ï¼š
   - `iadd`: æ‰§è¡Œä¸¤ä¸ªintç±»å‹æ“ä½œæ•°çš„ç›¸åŠ æ“ä½œã€‚
   - `ladd`: æ‰§è¡Œä¸¤ä¸ªlongç±»å‹æ“ä½œæ•°çš„ç›¸åŠ æ“ä½œã€‚
   - `fadd`: æ‰§è¡Œä¸¤ä¸ªfloatç±»å‹æ“ä½œæ•°çš„ç›¸åŠ æ“ä½œã€‚
   - `dadd`: æ‰§è¡Œä¸¤ä¸ªdoubleç±»å‹æ“ä½œæ•°çš„ç›¸åŠ æ“ä½œã€‚

2. å‡æ³•æŒ‡ä»¤ï¼ˆSubtraction Instructionsï¼‰ï¼š
   - `isub`: æ‰§è¡Œä¸¤ä¸ªintç±»å‹æ“ä½œæ•°çš„ç›¸å‡æ“ä½œã€‚
   - `lsub`: æ‰§è¡Œä¸¤ä¸ªlongç±»å‹æ“ä½œæ•°çš„ç›¸å‡æ“ä½œã€‚
   - `fsub`: æ‰§è¡Œä¸¤ä¸ªfloatç±»å‹æ“ä½œæ•°çš„ç›¸å‡æ“ä½œã€‚
   - `dsub`: æ‰§è¡Œä¸¤ä¸ªdoubleç±»å‹æ“ä½œæ•°çš„ç›¸å‡æ“ä½œã€‚

3. ä¹˜æ³•æŒ‡ä»¤ï¼ˆMultiplication Instructionsï¼‰ï¼š
   - `imul`: æ‰§è¡Œä¸¤ä¸ªintç±»å‹æ“ä½œæ•°çš„ç›¸ä¹˜æ“ä½œã€‚
   - `lmul`: æ‰§è¡Œä¸¤ä¸ªlongç±»å‹æ“ä½œæ•°çš„ç›¸ä¹˜æ“ä½œã€‚
   - `fmul`: æ‰§è¡Œä¸¤ä¸ªfloatç±»å‹æ“ä½œæ•°çš„ç›¸ä¹˜æ“ä½œã€‚
   - `dmul`: æ‰§è¡Œä¸¤ä¸ªdoubleç±»å‹æ“ä½œæ•°çš„ç›¸ä¹˜æ“ä½œã€‚

4. é™¤æ³•æŒ‡ä»¤ï¼ˆDivision Instructionsï¼‰ï¼š
   - `idiv`: æ‰§è¡Œä¸¤ä¸ªintç±»å‹æ“ä½œæ•°çš„ç›¸é™¤æ“ä½œã€‚
   - `ldiv`: æ‰§è¡Œä¸¤ä¸ªlongç±»å‹æ“ä½œæ•°çš„ç›¸é™¤æ“ä½œã€‚
   - `fdiv`: æ‰§è¡Œä¸¤ä¸ªfloatç±»å‹æ“ä½œæ•°çš„ç›¸é™¤æ“ä½œã€‚
   - `ddiv`: æ‰§è¡Œä¸¤ä¸ªdoubleç±»å‹æ“ä½œæ•°çš„ç›¸é™¤æ“ä½œã€‚

5. æ±‚ä½™æŒ‡ä»¤ï¼ˆRemainder Instructionsï¼‰ï¼š
   - `irem`: æ‰§è¡Œä¸¤ä¸ªintç±»å‹æ“ä½œæ•°çš„æ±‚ä½™æ“ä½œã€‚
   - `lrem`: æ‰§è¡Œä¸¤ä¸ªlongç±»å‹æ“ä½œæ•°çš„æ±‚ä½™æ“ä½œã€‚
   - `frem`: æ‰§è¡Œä¸¤ä¸ªfloatç±»å‹æ“ä½œæ•°çš„æ±‚ä½™æ“ä½œã€‚
   - `drem`: æ‰§è¡Œä¸¤ä¸ªdoubleç±»å‹æ“ä½œæ•°çš„æ±‚ä½™æ“ä½œã€‚

6. å–åæŒ‡ä»¤ï¼ˆNegation Instructionsï¼‰ï¼š
   - `ineg`: å¯¹ä¸€ä¸ªintç±»å‹æ“ä½œæ•°è¿›è¡Œå–åæ“ä½œã€‚
   - `lneg`: å¯¹ä¸€ä¸ªlongç±»å‹æ“ä½œæ•°è¿›è¡Œå–åæ“ä½œã€‚
   - `fneg`: å¯¹ä¸€ä¸ªfloatç±»å‹æ“ä½œæ•°è¿›è¡Œå–åæ“ä½œã€‚
   - `dneg`: å¯¹ä¸€ä¸ªdoubleç±»å‹æ“ä½œæ•°è¿›è¡Œå–åæ“ä½œã€‚

7. ä½ç§»æŒ‡ä»¤ï¼ˆShift Instructionsï¼‰ï¼š
   - `ishl`: å¯¹ä¸€ä¸ªintç±»å‹æ“ä½œæ•°è¿›è¡Œå·¦ç§»æ“ä½œã€‚
   - `ishr`: å¯¹ä¸€ä¸ªintç±»å‹æ“ä½œæ•°è¿›è¡Œå¸¦ç¬¦å·å³ç§»æ“ä½œã€‚
   - `iushr`: å¯¹ä¸€ä¸ªintç±»å‹æ“ä½œæ•°è¿›è¡Œæ— ç¬¦å·å³ç§»æ“ä½œã€‚
   - `lshl`: å¯¹ä¸€ä¸ªlongç±»å‹æ“ä½œæ•°è¿›è¡Œå·¦ç§»æ“ä½œã€‚
   - `lshr`: å¯¹ä¸€ä¸ªlongç±»å‹æ“ä½œæ•°è¿›è¡Œå¸¦ç¬¦å·å³ç§»æ“ä½œã€‚
   - `lushr`: å¯¹ä¸€ä¸ªlongç±»å‹æ“ä½œæ•°è¿›è¡Œæ— ç¬¦å·å³ç§»æ“ä½œã€‚

8. æŒ‰ä½æˆ–æŒ‡ä»¤ï¼ˆBitwise OR Instructionsï¼‰ï¼š
   - `ior`: å¯¹ä¸¤ä¸ªintç±»å‹æ“ä½œæ•°è¿›è¡ŒæŒ‰ä½æˆ–æ“ä½œã€‚
   - `lor`: å¯¹ä¸¤ä¸ªlongç±»å‹æ“ä½œæ•°è¿›è¡ŒæŒ‰ä½æˆ–æ“ä½œã€‚

9. æŒ‰ä½ä¸æŒ‡ä»¤ï¼ˆBitwise AND Instructionsï¼‰ï¼š
   - `iand`: å¯¹ä¸¤ä¸ªintç±»å‹æ“ä½œæ•°è¿›è¡ŒæŒ‰ä½ä¸æ“ä½œã€‚
   - `land`: å¯¹ä¸¤ä¸ªlongç±»å‹æ“ä½œæ•°è¿›è¡ŒæŒ‰ä½ä¸æ“ä½œã€‚

10. æŒ‰ä½å¼‚æˆ–æŒ‡ä»¤ï¼ˆBitwise XOR Instructionsï¼‰ï¼š
    - `ixor`: å¯¹ä¸¤ä¸ªintç±»å‹æ“ä½œæ•°è¿›è¡ŒæŒ‰ä½å¼‚æˆ–æ“ä½œã€‚
    - `lxor`: å¯¹ä¸¤ä¸ªlongç±»å‹æ“ä½œæ•°è¿›è¡ŒæŒ‰ä½å¼‚æˆ–æ“ä½œã€‚

11. å±€éƒ¨å˜é‡è‡ªå¢æŒ‡ä»¤ï¼ˆIncrement Instructionsï¼‰ï¼š
    - `iinc`: å¯¹ä¸€ä¸ªintç±»å‹çš„å±€éƒ¨å˜é‡è¿›è¡Œè‡ªå¢æ“ä½œã€‚

12. æ¯”è¾ƒæŒ‡ä»¤ï¼ˆComparison Instructionsï¼‰ï¼š
    - `dcmpg`: æ¯”è¾ƒä¸¤ä¸ªdoubleç±»å‹æ“ä½œæ•°çš„å¤§å°ï¼ˆå¸¦NaNå¤„ç†ï¼‰ã€‚
    - `dcmpl`: æ¯”è¾ƒä¸¤ä¸ªdoubleç±»å‹æ“ä½œæ•°çš„å¤§å°ï¼ˆå¸¦NaNå¤„ç†ï¼‰ã€‚
    - `fcmpg`: æ¯”è¾ƒä¸¤ä¸ªfloatç±»å‹æ“ä½œæ•°çš„å¤§å°ï¼ˆå¸¦NaNå¤„ç†ï¼‰ã€‚
    - `fcmpl`: æ¯”è¾ƒä¸¤ä¸ªfloatç±»å‹æ“ä½œæ•°çš„å¤§å°ï¼ˆå¸¦NaNå¤„ç†ï¼‰ã€‚
    - `lcmp`: æ¯”è¾ƒä¸¤ä¸ªlongç±»å‹æ“ä½œæ•°çš„å¤§å°ã€‚

****

### ç±»å‹è½¬æ¢æŒ‡ä»¤

****

1. æ•´æ•°ç±»å‹è½¬æ¢æŒ‡ä»¤ï¼ˆInteger Conversion Instructionsï¼‰ï¼š
   - `i2l`: å°†intç±»å‹è½¬æ¢ä¸ºlongç±»å‹ã€‚
   - `i2f`: å°†intç±»å‹è½¬æ¢ä¸ºfloatç±»å‹ã€‚
   - `i2d`: å°†intç±»å‹è½¬æ¢ä¸ºdoubleç±»å‹ã€‚
   - `l2i`: å°†longç±»å‹è½¬æ¢ä¸ºintç±»å‹ã€‚
   - `l2f`: å°†longç±»å‹è½¬æ¢ä¸ºfloatç±»å‹ã€‚
   - `l2d`: å°†longç±»å‹è½¬æ¢ä¸ºdoubleç±»å‹ã€‚
   - `f2i`: å°†floatç±»å‹è½¬æ¢ä¸ºintç±»å‹ã€‚
   - `f2l`: å°†floatç±»å‹è½¬æ¢ä¸ºlongç±»å‹ã€‚
   - `f2d`: å°†floatç±»å‹è½¬æ¢ä¸ºdoubleç±»å‹ã€‚
   - `d2i`: å°†doubleç±»å‹è½¬æ¢ä¸ºintç±»å‹ã€‚
   - `d2l`: å°†doubleç±»å‹è½¬æ¢ä¸ºlongç±»å‹ã€‚
   - `d2f`: å°†doubleç±»å‹è½¬æ¢ä¸ºfloatç±»å‹ã€‚

2. ç±»å‹å¼ºåˆ¶è½¬æ¢æŒ‡ä»¤ï¼ˆType Casting Instructionsï¼‰ï¼š
   - `checkcast`: æ£€æŸ¥å¯¹è±¡æ˜¯å¦å¯ä»¥å¼ºåˆ¶è½¬æ¢ä¸ºæŒ‡å®šç±»å‹ã€‚
   - `instanceof`: æ£€æŸ¥å¯¹è±¡æ˜¯å¦æ˜¯æŒ‡å®šç±»å‹çš„å®ä¾‹ã€‚

3. æ•°å€¼æ‹“å®½å’Œç¼©çª„æŒ‡ä»¤ï¼ˆNumeric Widening and Narrowing Instructionsï¼‰ï¼š
   - `i2b`: å°†intç±»å‹è½¬æ¢ä¸ºbyteç±»å‹ã€‚
   - `i2c`: å°†intç±»å‹è½¬æ¢ä¸ºcharç±»å‹ã€‚
   - `i2s`: å°†intç±»å‹è½¬æ¢ä¸ºshortç±»å‹ã€‚

****

### å¯¹è±¡åˆ›å»ºä¸è®¿é—®æŒ‡ä»¤

****

1. å¯¹è±¡åˆ›å»ºæŒ‡ä»¤ï¼ˆObject Creation Instructionsï¼‰ï¼š
   - `new`: åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œå¹¶å°†å…¶å¼•ç”¨æ¨é€åˆ°æ“ä½œæ•°æ ˆä¸Šã€‚
   - `newarray`: åˆ›å»ºä¸€ä¸ªæŒ‡å®šç±»å‹çš„æ–°æ•°ç»„ï¼Œå¹¶å°†å…¶å¼•ç”¨æ¨é€åˆ°æ“ä½œæ•°æ ˆä¸Šã€‚
   - `anewarray`: åˆ›å»ºä¸€ä¸ªå¼•ç”¨ç±»å‹çš„æ–°æ•°ç»„ï¼Œå¹¶å°†å…¶å¼•ç”¨æ¨é€åˆ°æ“ä½œæ•°æ ˆä¸Šã€‚
   - `multianewarray`: åˆ›å»ºä¸€ä¸ªå¤šç»´æ•°ç»„ï¼Œå¹¶å°†å…¶å¼•ç”¨æ¨é€åˆ°æ“ä½œæ•°æ ˆä¸Šã€‚

2. å¯¹è±¡è®¿é—®æŒ‡ä»¤ï¼ˆObject Access Instructionsï¼‰ï¼š
   - `getfield`: ä»å¯¹è±¡ä¸­è·å–å®ä¾‹å­—æ®µçš„å€¼ï¼Œå¹¶å°†å…¶æ¨é€åˆ°æ“ä½œæ•°æ ˆä¸Šã€‚
   - `putfield`: å°†ä¸€ä¸ªå€¼å­˜å‚¨åˆ°å¯¹è±¡çš„å®ä¾‹å­—æ®µä¸­ã€‚
   - `getstatic`: è·å–é™æ€å­—æ®µçš„å€¼ï¼Œå¹¶å°†å…¶æ¨é€åˆ°æ“ä½œæ•°æ ˆä¸Šã€‚
   - `putstatic`: å°†ä¸€ä¸ªå€¼å­˜å‚¨åˆ°é™æ€å­—æ®µä¸­ã€‚
   - `arraylength`: è·å–æ•°ç»„çš„é•¿åº¦ï¼Œå¹¶å°†å…¶æ¨é€åˆ°æ“ä½œæ•°æ ˆä¸Šã€‚
   - `aload`: ä»å±€éƒ¨å˜é‡è¡¨åŠ è½½ä¸€ä¸ªå¼•ç”¨ç±»å‹çš„å˜é‡åˆ°æ“ä½œæ ˆä¸Šã€‚

****

### æ“ä½œæ•°æ ˆç®¡ç†æŒ‡ä»¤

****

1. å‡ºæ ˆæŒ‡ä»¤ï¼ˆPop Instructionsï¼‰ï¼š
   - `pop`: å°†æ“ä½œæ•°æ ˆçš„æ ˆé¡¶å…ƒç´ å‡ºæ ˆã€‚
   - `pop2`: å°†æ“ä½œæ•°æ ˆçš„æ ˆé¡¶çš„ä¸€ä¸ªæˆ–ä¸¤ä¸ªå…ƒç´ å‡ºæ ˆã€‚

2. å¤åˆ¶æŒ‡ä»¤ï¼ˆDuplicate Instructionsï¼‰ï¼š
   - `dup`: å¤åˆ¶æ“ä½œæ•°æ ˆçš„æ ˆé¡¶å…ƒç´ ï¼Œå¹¶å°†å¤åˆ¶å€¼é‡æ–°å‹å…¥æ ˆé¡¶ã€‚
   - `dup2`: å¤åˆ¶æ“ä½œæ•°æ ˆçš„æ ˆé¡¶çš„ä¸€ä¸ªæˆ–ä¸¤ä¸ªå…ƒç´ ï¼Œå¹¶å°†å¤åˆ¶å€¼æˆ–åŒä»½çš„å¤åˆ¶å€¼é‡æ–°å‹å…¥æ ˆé¡¶ã€‚
   - `dup_x1`: å¤åˆ¶æ“ä½œæ•°æ ˆçš„æ ˆé¡¶å…ƒç´ ï¼Œå¹¶å°†å¤åˆ¶å€¼æ’å…¥æ ˆé¡¶ä¸‹é¢çš„ä¸€ä¸ªå…ƒç´ ä¹‹å‰ã€‚
   - `dup2_x1`: å¤åˆ¶æ“ä½œæ•°æ ˆçš„æ ˆé¡¶çš„ä¸€ä¸ªæˆ–ä¸¤ä¸ªå…ƒç´ ï¼Œå¹¶å°†å¤åˆ¶å€¼æˆ–åŒä»½çš„å¤åˆ¶å€¼æ’å…¥æ ˆé¡¶ä¸‹é¢çš„ä¸€ä¸ªå…ƒç´ ä¹‹å‰ã€‚
   - `dup_x2`: å¤åˆ¶æ“ä½œæ•°æ ˆçš„æ ˆé¡¶å…ƒç´ ï¼Œå¹¶å°†å¤åˆ¶å€¼æ’å…¥æ ˆé¡¶ä¸‹é¢çš„ä¸¤ä¸ªå…ƒç´ ä¹‹å‰ã€‚
   - `dup2_x2`: å¤åˆ¶æ“ä½œæ•°æ ˆçš„æ ˆé¡¶çš„ä¸€ä¸ªæˆ–ä¸¤ä¸ªå…ƒç´ ï¼Œå¹¶å°†å¤åˆ¶å€¼æˆ–åŒä»½çš„å¤åˆ¶å€¼æ’å…¥æ ˆé¡¶ä¸‹é¢çš„ä¸¤ä¸ªå…ƒç´ ä¹‹å‰ã€‚

3. äº¤æ¢æŒ‡ä»¤ï¼ˆSwap Instructionï¼‰ï¼š
   - `swap`: å°†æ“ä½œæ•°æ ˆæœ€é¡¶ç«¯çš„ä¸¤ä¸ªæ•°å€¼äº’æ¢ã€‚

****

### æ§åˆ¶è½¬ç§»æŒ‡ä»¤

****

1. æ¡ä»¶åˆ†æ”¯æŒ‡ä»¤ï¼š
   - `ifeq`: å¦‚æœæ ˆé¡¶å€¼ç­‰äº0ï¼Œåˆ™è·³è½¬åˆ°æŒ‡å®šä½ç½®ã€‚
   - `iflt`: å¦‚æœæ ˆé¡¶å€¼å°äº0ï¼Œåˆ™è·³è½¬åˆ°æŒ‡å®šä½ç½®ã€‚
   - `ifle`: å¦‚æœæ ˆé¡¶å€¼å°äºç­‰äº0ï¼Œåˆ™è·³è½¬åˆ°æŒ‡å®šä½ç½®ã€‚
   - `ifne`: å¦‚æœæ ˆé¡¶å€¼ä¸ç­‰äº0ï¼Œåˆ™è·³è½¬åˆ°æŒ‡å®šä½ç½®ã€‚
   - `ifgt`: å¦‚æœæ ˆé¡¶å€¼å¤§äº0ï¼Œåˆ™è·³è½¬åˆ°æŒ‡å®šä½ç½®ã€‚
   - `ifge`: å¦‚æœæ ˆé¡¶å€¼å¤§äºç­‰äº0ï¼Œåˆ™è·³è½¬åˆ°æŒ‡å®šä½ç½®ã€‚
   - `ifnull`: å¦‚æœæ ˆé¡¶å€¼ä¸ºnullï¼Œåˆ™è·³è½¬åˆ°æŒ‡å®šä½ç½®ã€‚
   - `ifnonnull`: å¦‚æœæ ˆé¡¶å€¼ä¸ä¸ºnullï¼Œåˆ™è·³è½¬åˆ°æŒ‡å®šä½ç½®ã€‚
   - `if_icmpeq`: å¦‚æœæ ˆé¡¶ä¸¤ä¸ªintå€¼ç›¸ç­‰ï¼Œåˆ™è·³è½¬åˆ°æŒ‡å®šä½ç½®ã€‚
   - `if_icmpne`: å¦‚æœæ ˆé¡¶ä¸¤ä¸ªintå€¼ä¸ç›¸ç­‰ï¼Œåˆ™è·³è½¬åˆ°æŒ‡å®šä½ç½®ã€‚
   - `if_icmplt`: å¦‚æœæ ˆé¡¶ç¬¬äºŒä¸ªintå€¼å°äºæ ˆé¡¶ç¬¬ä¸€ä¸ªintå€¼ï¼Œåˆ™è·³è½¬åˆ°æŒ‡å®šä½ç½®ã€‚
   - `if_icmpgt`: å¦‚æœæ ˆé¡¶ç¬¬äºŒä¸ªintå€¼å¤§äºæ ˆé¡¶ç¬¬ä¸€ä¸ªintå€¼ï¼Œåˆ™è·³è½¬åˆ°æŒ‡å®šä½ç½®ã€‚
   - `if_icmple`: å¦‚æœæ ˆé¡¶ç¬¬äºŒä¸ªintå€¼å°äºç­‰äºæ ˆé¡¶ç¬¬ä¸€ä¸ªintå€¼ï¼Œåˆ™è·³è½¬åˆ°æŒ‡å®šä½ç½®ã€‚
   - `if_icmpge`: å¦‚æœæ ˆé¡¶ç¬¬äºŒä¸ªintå€¼å¤§äºç­‰äºæ ˆé¡¶ç¬¬ä¸€ä¸ªintå€¼ï¼Œåˆ™è·³è½¬åˆ°æŒ‡å®šä½ç½®ã€‚
   - `if_acmpeq`: å¦‚æœæ ˆé¡¶ä¸¤ä¸ªå¼•ç”¨å€¼ç›¸ç­‰ï¼Œåˆ™è·³è½¬åˆ°æŒ‡å®šä½ç½®ã€‚
   - `if_acmpne`: å¦‚æœæ ˆé¡¶ä¸¤ä¸ªå¼•ç”¨å€¼ä¸ç›¸ç­‰ï¼Œåˆ™è·³è½¬åˆ°æŒ‡å®šä½ç½®ã€‚

2. å¤åˆæ¡ä»¶åˆ†æ”¯æŒ‡ä»¤ï¼š
   - `tableswitch`: æ ¹æ®ä¸€ä¸ªç´¢å¼•å€¼è¿›è¡Œè·³è½¬ï¼Œé€šè¿‡ç´¢å¼•å€¼åœ¨ä¸€å¼ è¡¨ä¸­æŸ¥æ‰¾è·³è½¬ä½ç½®ã€‚
   - `lookupswitch`: æ ¹æ®ä¸€ä¸ªé”®å€¼è¿›è¡Œè·³è½¬ï¼Œé€šè¿‡é”®å€¼åœ¨ä¸€å¼ è¡¨ä¸­æŸ¥æ‰¾è·³è½¬ä½ç½®ã€‚

3. æ— æ¡ä»¶åˆ†æ”¯æŒ‡ä»¤ï¼š
   - `goto`: æ— æ¡ä»¶è·³è½¬åˆ°æŒ‡å®šä½ç½®ã€‚
   - `goto_w`: æ— æ¡ä»¶è·³è½¬åˆ°æŒ‡å®šä½ç½®ï¼ˆæ‰©å±•ç´¢å¼•ï¼‰ã€‚
   - `jsr`: è·³è½¬åˆ°æŒ‡å®šä½ç½®ï¼Œå¹¶å°†è¿”å›åœ°å€å‹å…¥æ ˆé¡¶ã€‚
   - `jsr_w`: è·³è½¬åˆ°æŒ‡å®šä½ç½®ï¼ˆæ‰©å±•ç´¢å¼•ï¼‰ï¼Œå¹¶å°†è¿”å›åœ°å€å‹å…¥æ ˆé¡¶ã€‚
   - `ret`: è¿”å›åˆ°æŒ‡å®šçš„å±€éƒ¨å˜é‡ç´¢å¼•ä½ç½®ã€‚

****

### æ–¹æ³•è¿”å›æŒ‡ä»¤

****

æ–¹æ³•è¿”å›æŒ‡ä»¤æ˜¯æ ¹æ®è¿”å›å€¼çš„ç±»å‹åŒºåˆ†ï¼š

- `ireturn`ï¼šè¯¥æŒ‡ä»¤ç”¨äºè¿”å›booleanã€byteã€charã€shortå’Œintç±»å‹çš„è¿”å›å€¼ã€‚å®ƒå°†æ“ä½œæ•°æ ˆé¡¶çš„å€¼å¼¹å‡ºï¼Œå¹¶å°†å…¶ä½œä¸ºæ–¹æ³•çš„è¿”å›å€¼ã€‚ç„¶åï¼Œå°†è¿”å›å€¼ä¼ é€’ç»™è°ƒç”¨è¯¥æ–¹æ³•çš„æŒ‡ä»¤ã€‚
- `lreturn`ï¼šè¯¥æŒ‡ä»¤ç”¨äºè¿”å›longç±»å‹çš„è¿”å›å€¼ã€‚å®ƒå°†æ“ä½œæ•°æ ˆé¡¶çš„ä¸¤ä¸ªå…ƒç´ ï¼ˆé«˜ä½å’Œä½ä½ï¼‰å¼¹å‡ºï¼Œå¹¶å°†å®ƒä»¬ä½œä¸ºæ–¹æ³•çš„è¿”å›å€¼ã€‚ç„¶åï¼Œå°†è¿”å›å€¼ä¼ é€’ç»™è°ƒç”¨è¯¥æ–¹æ³•çš„æŒ‡ä»¤ã€‚
- `freturn`ï¼šè¯¥æŒ‡ä»¤ç”¨äºè¿”å›floatç±»å‹çš„è¿”å›å€¼ã€‚å®ƒå°†æ“ä½œæ•°æ ˆé¡¶çš„å€¼å¼¹å‡ºï¼Œå¹¶å°†å…¶ä½œä¸ºæ–¹æ³•çš„è¿”å›å€¼ã€‚ç„¶åï¼Œå°†è¿”å›å€¼ä¼ é€’ç»™è°ƒç”¨è¯¥æ–¹æ³•çš„æŒ‡ä»¤ã€‚
- `dreturn`ï¼šè¯¥æŒ‡ä»¤ç”¨äºè¿”å›doubleç±»å‹çš„è¿”å›å€¼ã€‚å®ƒå°†æ“ä½œæ•°æ ˆé¡¶çš„ä¸¤ä¸ªå…ƒç´ ï¼ˆé«˜ä½å’Œä½ä½ï¼‰å¼¹å‡ºï¼Œå¹¶å°†å®ƒä»¬ä½œä¸ºæ–¹æ³•çš„è¿”å›å€¼ã€‚ç„¶åï¼Œå°†è¿”å›å€¼ä¼ é€’ç»™è°ƒç”¨è¯¥æ–¹æ³•çš„æŒ‡ä»¤ã€‚
- `areturn`ï¼šè¯¥æŒ‡ä»¤ç”¨äºè¿”å›å¼•ç”¨ç±»å‹ï¼ˆObjectç±»å‹ï¼‰çš„è¿”å›å€¼ã€‚å®ƒå°†æ“ä½œæ•°æ ˆé¡¶çš„å¼•ç”¨å€¼å¼¹å‡ºï¼Œå¹¶å°†å…¶ä½œä¸ºæ–¹æ³•çš„è¿”å›å€¼ã€‚ç„¶åï¼Œå°†è¿”å›å€¼ä¼ é€’ç»™è°ƒç”¨è¯¥æ–¹æ³•çš„æŒ‡ä»¤ã€‚
- `return`ï¼šè¯¥æŒ‡ä»¤ç”¨äºç»“æŸæ–¹æ³•çš„æ‰§è¡Œï¼Œå¹¶è¿”å›åˆ°è°ƒç”¨è¯¥æ–¹æ³•çš„æŒ‡ä»¤ã€‚è¯¥æŒ‡ä»¤é€šå¸¸ç”¨äºå£°æ˜ä¸ºvoidçš„æ–¹æ³•ã€å®ä¾‹åˆå§‹åŒ–æ–¹æ³•ã€ç±»å’Œæ¥å£çš„ç±»åˆå§‹åŒ–æ–¹æ³•ã€‚å®ƒæ²¡æœ‰è¿”å›å€¼ã€‚

****

# è™šæ‹Ÿæœºå­—èŠ‚ç æ‰§è¡Œå¼•æ“

****

## æ‰§è¡Œå¼•æ“æ¦‚è¿°

****

æˆ‘ä»¬åœ¨ `Java` å†…å­˜æ¨¡å‹çš„ç¯‡ç« å·²ç»ä»‹ç»äº†è™šæ‹Ÿæœºçš„è¿è¡Œæ—¶åŒºåŸŸï¼Œä¸ç†Ÿæ‚‰çš„æœ‹å‹å¯ä»¥å¿«é€Ÿå›é¡¾ä¸€ç•ª [æ·±å…¥ç†è§£ JVM ä¹‹â€”â€”Java å†…å­˜åŒºåŸŸä¸æº¢å‡ºå¼‚å¸¸](https://lys2021.com/?p=1553)ã€‚

![image-20230831150214981](https://image.itbaima.net/images/40/image-20230831157163998.png)

é‚£ä¹ˆç°åœ¨æˆ‘ä»¬åº”è¯¥æ¥è®²è®²æ‰§è¡Œå¼•æ“äº†â€”â€”**æ‰§è¡Œå¼•æ“æ˜¯Javaè™šæ‹Ÿæœºæ ¸å¿ƒçš„ç»„æˆéƒ¨åˆ†ä¹‹ä¸€**ã€‚

æ‰§è¡Œå¼•æ“ï¼ˆExecution Engineï¼‰ï¼šè´Ÿè´£æ‰§è¡ŒåŠ è½½åˆ°å†…å­˜ä¸­çš„å­—èŠ‚ç æŒ‡ä»¤ï¼Œå°†å…¶è½¬æ¢ä¸ºæœºå™¨ç å¹¶æ‰§è¡Œã€‚æ‰§è¡Œå¼•æ“é€šå¸¸åŒ…æ‹¬è§£é‡Šå™¨ï¼ˆInterpreterï¼‰å’Œå³æ—¶ç¼–è¯‘å™¨ï¼ˆJust-In-Time Compilerï¼ŒJITï¼‰ä¸¤ä¸ªéƒ¨åˆ†ã€‚

- è§£é‡Šå™¨ï¼šé€è¡Œè§£é‡Šæ‰§è¡Œå­—èŠ‚ç æŒ‡ä»¤ï¼Œç›¸å¯¹è¾ƒæ…¢ä½†å…·æœ‰è·¨å¹³å°çš„ä¼˜åŠ¿ã€‚
- å³æ—¶ç¼–è¯‘å™¨ï¼šå°†çƒ­ç‚¹ä»£ç ç¼–è¯‘ä¸ºæœ¬åœ°æœºå™¨ç ï¼Œä»¥æé«˜æ‰§è¡Œé€Ÿåº¦ã€‚å³æ—¶ç¼–è¯‘å™¨ä¼šæ ¹æ®ä»£ç çš„æ‰§è¡Œæƒ…å†µè¿›è¡Œä¼˜åŒ–ï¼Œä»¥è·å¾—æ›´å¥½çš„æ€§èƒ½ã€‚

> åœ¨ã€ŠJavaè™šæ‹Ÿæœºè§„èŒƒã€‹ä¸­åˆ¶å®šäº†Javaè™šæ‹Ÿæœºå­—èŠ‚ç æ‰§è¡Œå¼•æ“çš„æ¦‚å¿µæ¨¡å‹ï¼Œåœ¨ä¸åŒçš„è™šæ‹Ÿæœºå®ç°ä¸­ï¼Œæ‰§è¡Œå¼•æ“åœ¨æ‰§è¡Œå­—èŠ‚ç çš„æ—¶å€™ï¼Œé€šå¸¸ä¼šæœ‰è§£é‡Šæ‰§è¡Œï¼ˆé€šè¿‡è§£é‡Šå™¨æ‰§è¡Œï¼‰å’Œç¼–è¯‘æ‰§è¡Œï¼ˆé€šè¿‡å³æ—¶ç¼–è¯‘å™¨äº§ç”Ÿæœ¬åœ°ä»£ç æ‰§è¡Œï¼‰ä¸¤ç§é€‰æ‹©ï¼Œä¹Ÿå¯èƒ½ä¸¤è€…å…¼å¤‡ï¼Œè¿˜å¯èƒ½ä¼šæœ‰åŒæ—¶åŒ…å«å‡ ä¸ªä¸åŒçº§åˆ«çš„å³æ—¶ç¼–è¯‘å™¨ä¸€èµ·å·¥ä½œçš„æ‰§è¡Œå¼•æ“ã€‚

æ‰€æœ‰çš„ `Java` è™šæ‹Ÿæœºçš„æ‰§è¡Œå¼•æ“è¾“å…¥ã€è¾“å‡ºéƒ½æ˜¯ä¸€è‡´çš„ï¼š**è¾“å…¥çš„æ˜¯å­—èŠ‚ç äºŒè¿›åˆ¶æµï¼Œå¤„ç†è¿‡ç¨‹æ˜¯å­—èŠ‚ç è§£ææ‰§è¡Œçš„ç­‰æ•ˆè¿‡ç¨‹ï¼Œè¾“å‡ºçš„æ˜¯æ‰§è¡Œç»“æœ**ã€‚

****

## è¿è¡Œæ—¶çš„æ ˆå¸§ç»“æ„

****

`Java` è™šæ‹Ÿæœºçš„æ ˆå¸§æ˜¯æ”¯æŒæ–¹æ³•è°ƒç”¨å’Œæ–¹æ³•æ‰§è¡Œçš„æ•°æ®ç»“æ„ï¼Œ**å®ƒæ˜¯è™šæ‹Ÿæœºæ ˆçš„å…ƒç´ ä¹‹ä¸€**ã€‚

æ ˆå¸§å­˜å‚¨äº†æ–¹æ³•çš„å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€è¿æ¥å’Œæ–¹æ³•è¿”å›åœ°å€ç­‰ä¿¡æ¯

1. å±€éƒ¨å˜é‡è¡¨ï¼ˆLocal Variable Tableï¼‰ï¼šæ ˆå¸§ä¸­çš„å±€éƒ¨å˜é‡è¡¨ç”¨äºå­˜å‚¨æ–¹æ³•ä¸­çš„å±€éƒ¨å˜é‡å’Œå‚æ•°ã€‚å±€éƒ¨å˜é‡è¡¨æ˜¯ä¸€ä¸ªæ•°å­—ç´¢å¼•çš„æ•°ç»„ï¼Œç”¨äºå­˜å‚¨å„ç§æ•°æ®ç±»å‹çš„å€¼ï¼ŒåŒ…æ‹¬åŸºæœ¬ç±»å‹å’Œå¯¹è±¡å¼•ç”¨ã€‚

2. æ“ä½œæ•°æ ˆï¼ˆOperand Stackï¼‰ï¼šæ ˆå¸§ä¸­çš„æ“ä½œæ•°æ ˆç”¨äºæ‰§è¡Œæ–¹æ³•çš„æ“ä½œã€‚å®ƒæ˜¯ä¸€ä¸ªåè¿›å…ˆå‡ºï¼ˆLIFOï¼‰çš„æ ˆç»“æ„ï¼Œç”¨äºå­˜å‚¨æ–¹æ³•æ‰§è¡Œè¿‡ç¨‹ä¸­çš„ä¸´æ—¶æ•°æ®å’Œè®¡ç®—ç»“æœã€‚æ“ä½œæ•°æ ˆæä¾›äº†ä¸€ç»„æŒ‡ä»¤ï¼Œç”¨äºå¯¹æ ˆé¡¶å…ƒç´ è¿›è¡Œæ“ä½œã€‚

3. åŠ¨æ€è¿æ¥ï¼ˆDynamic Linkingï¼‰ï¼šæ ˆå¸§ä¸­çš„åŠ¨æ€è¿æ¥ç”¨äºæ”¯æŒæ–¹æ³•è°ƒç”¨å’Œæ–¹æ³•æ‰§è¡Œè¿‡ç¨‹ä¸­çš„åŠ¨æ€é“¾æ¥ã€‚å®ƒåŒ…å«äº†æ–¹æ³•çš„è¿è¡Œæ—¶å¸¸é‡æ± å¼•ç”¨ï¼Œç”¨äºåœ¨è¿è¡Œæ—¶è§£æç¬¦å·å¼•ç”¨ã€‚

4. æ–¹æ³•è¿”å›åœ°å€ï¼ˆReturn Addressï¼‰ï¼šæ ˆå¸§ä¸­çš„æ–¹æ³•è¿”å›åœ°å€ç”¨äºè®°å½•æ–¹æ³•è°ƒç”¨å®Œæˆåçš„è¿”å›ä½ç½®ã€‚å½“æ–¹æ³•æ‰§è¡Œå®Œæˆåï¼Œç¨‹åºå°†è¿”å›åˆ°è¯¥åœ°å€ç»§ç»­æ‰§è¡Œã€‚

**é‡ç‚¹**ï¼š

* æ ˆå¸§æ˜¯æ–¹æ³•è°ƒç”¨å’Œæ–¹æ³•æ‰§è¡Œçš„åŸºæœ¬å•ä½ï¼Œæ¯ä¸ªæ–¹æ³•åœ¨è™šæ‹Ÿæœºæ ˆä¸­éƒ½å¯¹åº”ä¸€ä¸ªæ ˆå¸§ã€‚
* æ ˆå¸§çš„å¤§å°åœ¨ç¼–è¯‘é˜¶æ®µå°±ç¡®å®šï¼Œå¹¶ä¸”ä¸ç¨‹åºè¿è¡ŒæœŸå˜é‡æ•°æ®æ— å…³ã€‚
* åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œåªæœ‰ä½äºæ ˆé¡¶çš„æ–¹æ³•å¯¹åº”çš„æ ˆå¸§æ˜¯ç”Ÿæ•ˆçš„ï¼Œè¢«ç§°ä¸ºå½“å‰æ ˆå¸§ï¼Œä¸ä¹‹å…³è”çš„æ–¹æ³•ç§°ä¸ºå½“å‰æ–¹æ³•ã€‚
* æ‰§è¡Œå¼•æ“é’ˆå¯¹å½“å‰æ ˆå¸§è¿›è¡Œæ“ä½œï¼Œæ‰§è¡Œå­—èŠ‚ç æŒ‡ä»¤ã€‚

****

## å­—èŠ‚ç çš„è§£é‡Šæ‰§è¡Œ

****

> `Java` è¯­è¨€ç»å¸¸è¢«äººä»¬å®šä½ä¸ºâ€œè§£é‡Šæ‰§è¡Œâ€çš„è¯­è¨€ï¼Œåœ¨Javaåˆç”Ÿçš„ `JDK1.0` æ—¶ä»£ï¼Œè¿™ç§å®šä¹‰è¿˜ç®—æ˜¯æ¯”è¾ƒå‡†ç¡®çš„ï¼Œä½†å½“ä¸»æµçš„è™šæ‹Ÿæœºä¸­éƒ½åŒ…å«äº†å³æ—¶ç¼–è¯‘å™¨åï¼ŒClass æ–‡ä»¶ä¸­çš„ä»£ç åˆ°åº•ä¼šè¢«è§£é‡Šæ‰§è¡Œè¿˜æ˜¯ç¼–è¯‘æ‰§è¡Œï¼Œå°±æˆäº†åªæœ‰è™šæ‹Ÿæœºè‡ªå·±æ‰èƒ½å‡†ç¡®åˆ¤æ–­çš„äº‹ã€‚

****

### åŸºäºæ ˆçš„æŒ‡ä»¤é›†å’ŒåŸºäºå¯„å­˜å™¨çš„æŒ‡ä»¤é›†

****

æˆ‘ä»¬åœ¨å‰æ–‡æåˆ°è¿‡ç”¨ `javac` ç¼–è¯‘å™¨å°† `.java` æ–‡ä»¶ç¼–è¯‘æˆ `.class` æ–‡ä»¶ï¼Œè¿™ä¸ªè¿‡ç¨‹å…¶å®å°±æ˜¯ `Javac` ç¼–è¯‘å™¨è¾“å‡ºçš„å­—èŠ‚ç æŒ‡ä»¤æµçš„è¿‡ç¨‹ï¼Œè¿™ä¸ªè¿‡ç¨‹å®é™…ä¸Šæ˜¯ä¸€ç§åŸºäºæ ˆçš„æŒ‡ä»¤é›†æ¶æ„ï¼ˆInstruction Set Architectureï¼ŒISAï¼‰å®Œæˆçš„ï¼Œé€šè¿‡è¿™ç§æ–¹å¼å¾—åˆ°çš„å­—èŠ‚ç æŒ‡ä»¤æµé‡Œé¢çš„æŒ‡ä»¤å¤§éƒ¨åˆ†éƒ½æ˜¯é›¶åœ°å€æŒ‡ä»¤ï¼Œå®ƒä»¬**ä¾èµ–æ“ä½œæ•°æ ˆè¿›è¡Œå·¥ä½œ**ã€‚

ä¸â€œåŸºäºæ ˆçš„æŒ‡ä»¤é›†æ¶æ„â€ç›¸å¯¹çš„æ˜¯â€œåŸºäºå¯„å­˜å™¨çš„æŒ‡ä»¤é›†â€ï¼Œå¦‚æˆ‘ä»¬æœ€ç†Ÿæ‚‰çš„ `x86` äºŒåœ°å€æŒ‡ä»¤é›†ï¼Œè¿™ä¹Ÿæ˜¯å½“ä»Šä¸»æµ `PC` æœºä¸­ç‰©ç†ç¡¬ä»¶ç›´æ¥æ”¯æŒçš„æŒ‡ä»¤é›†æ¶æ„ï¼Œè¿™äº›æŒ‡ä»¤**ä¾èµ–å¯„å­˜å™¨è¿›è¡Œå·¥ä½œ**ã€‚

ä¾‹å¦‚è®¡ç®—ï¼š$1 + 1$ ä¸¤ç§æŒ‡ä»¤é›†çœ‹èµ·æ¥æ˜¯ä¸‹é¢è¿™æ ·ï¼š

åŸºäºæ ˆçš„æŒ‡ä»¤é›†ï¼š

```
iconst_1
iconst_1
iadd
istore_0
```

å¯¹äºä¸Šé¢çš„æŒ‡ä»¤ï¼š

1. `iconst_1`: å°†å¸¸é‡å€¼ $1$ å‹å…¥æ“ä½œæ•°æ ˆé¡¶ã€‚
2. `iconst_1`: å°†å¸¸é‡å€¼ $2$ å‹å…¥æ“ä½œæ•°æ ˆé¡¶ã€‚
3. `iadd`: ä»æ“ä½œæ•°æ ˆä¸­å¼¹å‡ºä¸¤ä¸ªæ•´æ•°å€¼ï¼Œå°†å®ƒä»¬ç›¸åŠ ï¼Œå¹¶å°†ç»“æœå‹å…¥æ“ä½œæ•°æ ˆé¡¶ã€‚
4. `istore_0`: å°†æ ˆé¡¶çš„æ•´æ•°å€¼å­˜å‚¨åˆ°å±€éƒ¨å˜é‡è¡¨ä¸­ç´¢å¼•ä¸º $0$ çš„ä½ç½®ã€‚

åŸºäºå¯„å­˜å™¨çš„æŒ‡ä»¤é›†ï¼š

```
mov eax, 1
add eax, 1
```

å¯¹äºä¸Šé¢çš„æŒ‡ä»¤ï¼š

1. `mov eax, 1`: å°†æ•´æ•°å€¼ $1$ å­˜å‚¨åˆ° `eax` å¯„å­˜å™¨ä¸­ã€‚
2. `add eax, 1`: è¿™æ˜¯ä¸€ä¸ªå°†å¯„å­˜å™¨ `eax` ä¸­çš„å€¼ä¸å¸¸é‡å€¼ $1$ ç›¸åŠ ï¼Œå¹¶å°†ç»“æœå­˜å‚¨å› `eax` å¯„å­˜å™¨ã€‚

è¿™ä¸¤å¥—æŒ‡ä»¤é›†åŒæ—¶å¹¶å­˜å’Œå‘å±•ï¼Œå„æœ‰ä¼˜åŠ¿ã€‚

åŸºäºæ ˆçš„æŒ‡ä»¤é›†ï¼š

1. ä¼˜ç‚¹ï¼š
   - å¯ç§»æ¤æ€§ï¼šç”±äºä¸ç›´æ¥ä¾èµ–ç¡¬ä»¶å¯„å­˜å™¨ï¼Œæ ˆæŒ‡ä»¤é›†æ›´å…·å¯ç§»æ¤æ€§ï¼Œå¯ä»¥åœ¨ä¸åŒçš„ç¡¬ä»¶å¹³å°ä¸Šè¿è¡Œã€‚
   - ä»£ç ç´§å‡‘ï¼šæ ˆæŒ‡ä»¤é›†çš„æŒ‡ä»¤ç›¸å¯¹è¾ƒå°‘ï¼Œä½¿å¾—ç”Ÿæˆçš„å­—èŠ‚ç æ›´ç´§å‡‘ã€‚
   - ç®€åŒ–ç¼–è¯‘å™¨å®ç°ï¼šæ ˆæŒ‡ä»¤é›†ä¸éœ€è¦è€ƒè™‘å¯„å­˜å™¨åˆ†é…ç­‰é—®é¢˜ï¼Œç¼–è¯‘å™¨çš„å®ç°ç›¸å¯¹ç®€å•ã€‚
2. ç¼ºç‚¹ï¼š
   - æ‰§è¡Œé€Ÿåº¦è¾ƒæ…¢ï¼šæ ˆæŒ‡ä»¤é›†éœ€è¦é¢‘ç¹è¿›è¡Œæ ˆæ“ä½œå’Œå†…å­˜è®¿é—®ï¼Œå†…å­˜è®¿é—®å¼€é”€å¤§ï¼Œç›¸å¯¹äºåŸºäºå¯„å­˜å™¨çš„æŒ‡ä»¤é›†æ‰§è¡Œé€Ÿåº¦è¾ƒæ…¢ã€‚

åŸºäºå¯„å­˜å™¨çš„æŒ‡ä»¤é›†ï¼š

1. ä¼˜ç‚¹ï¼š
   - è¾ƒé«˜çš„æ‰§è¡Œé€Ÿåº¦ï¼šåŸºäºå¯„å­˜å™¨çš„æŒ‡ä»¤é›†åœ¨æ‰§è¡Œé€Ÿåº¦ä¸Šé€šå¸¸è¾ƒå¿«ï¼Œå› ä¸ºå¯„å­˜å™¨æ“ä½œé€Ÿåº¦å¿«ï¼Œæ— éœ€é¢‘ç¹çš„å†…å­˜è®¿é—®ã€‚
   - æ›´æ¥è¿‘ç‰©ç†æœºçš„æŒ‡ä»¤é›†ï¼šä¸»æµç‰©ç†æœºçš„æŒ‡ä»¤é›†éƒ½æ˜¯åŸºäºå¯„å­˜å™¨çš„ï¼Œå› æ­¤åŸºäºå¯„å­˜å™¨çš„æŒ‡ä»¤é›†æ›´è´´è¿‘ç¡¬ä»¶å®ç°ã€‚
2. ç¼ºç‚¹ï¼š
   - ç¡¬ä»¶ä¾èµ–æ€§ï¼šåŸºäºå¯„å­˜å™¨çš„æŒ‡ä»¤é›†ç›´æ¥ä¾èµ–ç¡¬ä»¶å¯„å­˜å™¨ï¼Œå› æ­¤åœ¨ä¸åŒçš„ç¡¬ä»¶å¹³å°ä¸Šå¯èƒ½å­˜åœ¨å·®å¼‚ï¼Œå¯ç§»æ¤æ€§è¾ƒå·®ã€‚
   - ç¼–è¯‘å™¨å¤æ‚æ€§ï¼šåŸºäºå¯„å­˜å™¨çš„æŒ‡ä»¤é›†éœ€è¦è€ƒè™‘å¯„å­˜å™¨åˆ†é…ç­‰å¤æ‚é—®é¢˜ï¼Œç¼–è¯‘å™¨çš„å®ç°ç›¸å¯¹è¾ƒå¤æ‚ã€‚

****

### åŸºäºæ ˆçš„è§£é‡Šå™¨æ‰§è¡Œè¿‡ç¨‹

****

æ¥ä¸‹çœ‹æˆ‘ä»¬å…·ä½“çœ‹ä¸€ä¸ªå®é™…çš„ä»£ç ç¤ºä¾‹ï¼š

```java
public class Test {
    public static void main(String[] args) {
        int a = 114;
        int b = 514;
        int c = a + b;
    }
}
```

å°†ä¸Šè¿°ä»£ç ä¿å­˜ä¸º `Test.java` ç„¶åå¯¹å…¶è¿›è¡Œç¼–è¯‘å’Œåç¼–è¯‘ï¼š

```shell
javac Test.java
javap -v Test.class
```

å¯ä»¥çœ‹åˆ°è¾“å‡ºäº†å¦‚ä¸‹å†…å®¹ï¼š

```java
Classfile /L:/JAVA/BasicSyntax/Learn_JVM/code/Test.class
  Last modified 2023å¹´9æœˆ6æ—¥; size 276 bytes
  SHA-256 checksum 4064a19d96fe4d72c9d780ef819e1e937b120c31b37482e0b74c70e37c2a5601
  Compiled from "Test.java"
public class Test
  minor version: 0
  major version: 61
  flags: (0x0021) ACC_PUBLIC, ACC_SUPER
  this_class: #7                          // Test
  super_class: #2                         // java/lang/Object
  interfaces: 0, fields: 0, methods: 2, attributes: 1
Constant pool:
   #1 = Methodref          #2.#3          // java/lang/Object."<init>":()V
   #2 = Class              #4             // java/lang/Object
   #3 = NameAndType        #5:#6          // "<init>":()V
   #4 = Utf8               java/lang/Object
   #5 = Utf8               <init>
   #6 = Utf8               ()V
   #7 = Class              #8             // Test
   #8 = Utf8               Test
   #9 = Utf8               Code
  #10 = Utf8               LineNumberTable
  #11 = Utf8               main
  #12 = Utf8               ([Ljava/lang/String;)V
  #13 = Utf8               SourceFile
  #14 = Utf8               Test.java
{
  public Test();
    descriptor: ()V
    flags: (0x0001) ACC_PUBLIC
    Code:
      stack=1, locals=1, args_size=1
         0: aload_0
         1: invokespecial #1                  // Method java/lang/Object."<init>":()V
         4: return
      LineNumberTable:
        line 1: 0

  public static void main(java.lang.String[]);
    descriptor: ([Ljava/lang/String;)V
    flags: (0x0009) ACC_PUBLIC, ACC_STATIC
    Code:
      stack=2, locals=4, args_size=1
         0: bipush        114
         2: istore_1
         3: sipush        514
         6: istore_2
         7: iload_1
         8: iload_2
         9: iadd
        10: istore_3
        11: return
      LineNumberTable:
        line 3: 0
        line 4: 3
        line 5: 7
        line 6: 11
}
SourceFile: "Test.java"
```

æˆ‘ä»¬ä¸“æ³¨äºä¸‹åˆ—ä¿¡æ¯ï¼š

```java
public static void main(java.lang.String[]);
    descriptor: ([Ljava/lang/String;)V
    flags: (0x0009) ACC_PUBLIC, ACC_STATIC
    Code:
      stack=2, locals=4, args_size=1
         0: bipush        114
         2: istore_1
         3: sipush        514
         6: istore_2
         7: iload_1
         8: iload_2
         9: iadd
        10: istore_3
        11: return
```

å…¶ä¸­ï¼š

- `public static void main(java.lang.String[])`ï¼šè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªå…¬å…±çš„é™æ€æ–¹æ³•ï¼Œæ–¹æ³•åä¸º `main`ï¼Œå®ƒæ¥å—ä¸€ä¸ª `java.lang.String` ç±»å‹çš„æ•°ç»„ä½œä¸ºå‚æ•°ã€‚
- `descriptor: ([Ljava/lang/String;)V`ï¼šè¯´æ˜äº†æ–¹æ³•çš„æè¿°ç¬¦ï¼Œå…¶ä¸­ `([Ljava/lang/String;)` è¡¨ç¤ºå‚æ•°ç±»å‹ä¸º `java.lang.String` ç±»å‹çš„æ•°ç»„ï¼Œ`V` è¡¨ç¤ºæ–¹æ³•çš„è¿”å›ç±»å‹ä¸º `void`ã€‚
- `flags: (0x0009) ACC_PUBLIC, ACC_STATIC`ï¼šè¿™æ˜¯æ–¹æ³•çš„æ ‡å¿—ï¼Œå…¶ä¸­ `ACC_PUBLIC` è¡¨ç¤ºè¯¥æ–¹æ³•æ˜¯å…¬å…±çš„ï¼Œ`ACC_STATIC` è¡¨ç¤ºè¯¥æ–¹æ³•æ˜¯é™æ€çš„ã€‚

æˆ‘ä»¬é’ˆå¯¹å…¶ä¸­çš„ `main` å…¥å£ä»£ç  `Code` å±•ç¤ºè§£é‡Šå™¨çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œå…¶ä¸­ï¼š

```
stack=2, locals=4, args_size=1
```

æç¤ºæˆ‘ä»¬è¿™æ®µä»£ç éœ€è¦æ·±åº¦ä¸º $2$ çš„æ“ä½œæ•°æ ˆã€ $4$ ä¸ªå˜é‡æ§½çš„å±€éƒ¨å˜é‡ç©ºé—´å’Œ $1$ ä¸ªæ–¹æ³•å‚æ•°ã€‚

æ ¹æ®ç»™å®šçš„å­—èŠ‚ç æŒ‡ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥æ¨¡æ‹Ÿæ‰§è¡Œç¨‹åºå¹¶è·Ÿè¸ªæ“ä½œæ•°æ ˆã€å±€éƒ¨å˜é‡è¡¨å’Œç¨‹åºè®¡æ•°å™¨çš„åŠ¨æ€å˜åŒ–è¿‡ç¨‹ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ“ä½œæ•°æ ˆï¼ˆoperand stackï¼‰å’Œä¸€ä¸ªå±€éƒ¨å˜é‡è¡¨ï¼ˆlocal variable tableï¼‰ï¼Œå¹¶åˆå§‹åŒ–ç¨‹åºè®¡æ•°å™¨ï¼ˆprogram counterï¼‰ä¸º0ã€‚

```
æ‰§è¡Œï¼š0: bipush        114
æ“ä½œæ•°æ ˆçŠ¶æ€ï¼š[114ï¼ˆæ ˆé¡¶ï¼‰, null]
å±€éƒ¨å˜é‡è¡¨çŠ¶æ€ï¼š[thisï¼ˆç´¢å¼•èµ·å§‹ï¼‰, null, null, null]
ç¨‹åºè®¡æ•°å™¨çŠ¶æ€ï¼š0
```

```
æ‰§è¡Œï¼š2: istore_1
æ“ä½œæ•°æ ˆçŠ¶æ€ï¼š[nullï¼ˆæ ˆé¡¶ï¼‰, null]
å±€éƒ¨å˜é‡è¡¨çŠ¶æ€ï¼š[this, 114, null, null]
ç¨‹åºè®¡æ•°å™¨çŠ¶æ€ï¼š2
```

```
æ‰§è¡Œï¼š3: sipush        514
æ“ä½œæ•°æ ˆçŠ¶æ€ï¼š[514ï¼ˆæ ˆé¡¶ï¼‰, null]
å±€éƒ¨å˜é‡è¡¨çŠ¶æ€ï¼š[this, 114, null, null]
ç¨‹åºè®¡æ•°å™¨çŠ¶æ€ï¼š3
```

```
æ‰§è¡Œï¼š6: istore_2
æ“ä½œæ•°æ ˆçŠ¶æ€ï¼š[nulï¼ˆæ ˆé¡¶ï¼‰, null]
å±€éƒ¨å˜é‡è¡¨çŠ¶æ€ï¼š[this, 114, 514, null]
ç¨‹åºè®¡æ•°å™¨çŠ¶æ€ï¼š6
```

```
æ‰§è¡Œï¼š7: iload_1
æ“ä½œæ•°æ ˆçŠ¶æ€ï¼š[114ï¼ˆæ ˆé¡¶ï¼‰, null]
å±€éƒ¨å˜é‡è¡¨çŠ¶æ€ï¼š[this, 114, 514, null]
ç¨‹åºè®¡æ•°å™¨çŠ¶æ€ï¼š7
```

```
æ‰§è¡Œï¼š8: iload_2
æ“ä½œæ•°æ ˆçŠ¶æ€ï¼š[114ï¼ˆæ ˆé¡¶ï¼‰, 514]
å±€éƒ¨å˜é‡è¡¨çŠ¶æ€ï¼š[this, 114, 514, null]
ç¨‹åºè®¡æ•°å™¨çŠ¶æ€ï¼š8
```

```
æ‰§è¡Œï¼š9: iadd
æ“ä½œæ•°æ ˆçŠ¶æ€ï¼š[628ï¼ˆæ ˆé¡¶ï¼‰, null]
å±€éƒ¨å˜é‡è¡¨çŠ¶æ€ï¼š[this, 114, 514, null]
ç¨‹åºè®¡æ•°å™¨çŠ¶æ€ï¼š9
```

```
æ‰§è¡Œï¼š10: istore_3
æ“ä½œæ•°æ ˆçŠ¶æ€ï¼š[nullï¼ˆæ ˆé¡¶ï¼‰, null]
å±€éƒ¨å˜é‡è¡¨çŠ¶æ€ï¼š[this, 114, 514, 628]
ç¨‹åºè®¡æ•°å™¨çŠ¶æ€ï¼š10
```

```
æ‰§è¡Œï¼š11: return
æ“ä½œæ•°æ ˆçŠ¶æ€ï¼š[nullï¼ˆæ ˆé¡¶ï¼‰, null]
å±€éƒ¨å˜é‡è¡¨çŠ¶æ€ï¼š[this, 114, 514, 628]
ç¨‹åºè®¡æ•°å™¨çŠ¶æ€ï¼š11
```

ä¸Šé¢çš„æ‰§è¡Œè¿‡ç¨‹ä»…ä»…æ˜¯ä¸€ç§æ¦‚å¿µæ¨¡å‹ï¼Œ**è™šæ‹Ÿæœºæœ€ç»ˆä¼šå¯¹æ‰§è¡Œè¿‡ç¨‹åšå‡ºä¸€ç³»åˆ—ä¼˜åŒ–æ¥æé«˜æ€§èƒ½**ï¼Œå®é™…çš„è¿ä½œè¿‡ç¨‹å¹¶ä¸ä¼šå®Œå…¨ç¬¦åˆæ¦‚å¿µæ¨¡å‹çš„æè¿°ã€‚

æ›´ç¡®åˆ‡åœ°è¯´ï¼Œå®é™…æƒ…å†µä¼šå’Œä¸Šé¢æè¿°çš„æ¦‚å¿µæ¨¡å‹å·®è·éå¸¸å¤§ï¼Œå·®è·äº§ç”Ÿçš„æ ¹æœ¬åŸå› æ˜¯è™šæ‹Ÿæœºä¸­è§£æå™¨å’Œå³æ—¶ç¼–è¯‘å™¨éƒ½ä¼šå¯¹è¾“å…¥çš„å­—èŠ‚ç è¿›è¡Œä¼˜åŒ–ï¼Œå³ä½¿è§£é‡Šå™¨ä¸­ä¹Ÿä¸æ˜¯æŒ‰ç…§å­—èŠ‚ç æŒ‡ä»¤å»é€æ¡æ‰§è¡Œçš„ã€‚

å…³äºç¼–è¯‘å™¨ä¼˜åŒ–çš„ç»†èŠ‚ï¼Œæˆ‘ä»¬ä¼šåœ¨ä»¥åçš„ç³»åˆ—æ–‡ç« ä¸­æåˆ°ã€‚

****

# æ–¹æ³•è°ƒç”¨æŒ‡ä»¤

****

## æŒ‡ä»¤æ¦‚è¿°

****

é’ˆå¯¹è°ƒç”¨ä¸åŒç±»å‹çš„æ–¹æ³•ï¼Œå­—èŠ‚ç æŒ‡ä»¤é›†é‡Œè®¾è®¡äº†ä¸åŒçš„æŒ‡ä»¤ï¼š

1. `invokestatic`ï¼šç”¨äºè°ƒç”¨é™æ€æ–¹æ³•ã€‚å¯ä»¥åœ¨ç±»åŠ è½½æ—¶å°†ç¬¦å·å¼•ç”¨è§£æä¸ºç›´æ¥å¼•ç”¨ã€‚

2. `invokespecial`ï¼šç”¨äºè°ƒç”¨å®ä¾‹æ„é€ å™¨ `<init>()` æ–¹æ³•ã€ç§æœ‰æ–¹æ³•å’Œçˆ¶ç±»ä¸­çš„æ–¹æ³•ã€‚ä¹Ÿå¯ä»¥åœ¨ç±»åŠ è½½æ—¶å°†ç¬¦å·å¼•ç”¨è§£æä¸ºç›´æ¥å¼•ç”¨ã€‚

3. `invokevirtual`ï¼šç”¨äºè°ƒç”¨æ‰€æœ‰çš„è™šæ–¹æ³•ã€‚æ ¹æ®å¯¹è±¡çš„å®é™…ç±»å‹è¿›è¡Œåˆ†æ´¾ï¼ˆè™šæ–¹æ³•åˆ†æ´¾ï¼‰ã€‚

4. `invokeinterface`ï¼šç”¨äºè°ƒç”¨æ¥å£æ–¹æ³•ï¼Œä¼šåœ¨è¿è¡Œæ—¶ç¡®å®šå®ç°è¯¥æ¥å£çš„å¯¹è±¡ï¼Œå¹¶é€‰æ‹©é€‚åˆçš„æ–¹æ³•è¿›è¡Œè°ƒç”¨ã€‚

5. `invokedynamic`ï¼šå…ˆåœ¨è¿è¡Œæ—¶åŠ¨æ€è§£æå‡ºè°ƒç”¨ç‚¹é™å®šç¬¦æ‰€å¼•ç”¨çš„æ–¹æ³•ï¼Œç„¶åå†æ‰§è¡Œè¯¥æ–¹æ³•ã€‚åˆ†æ´¾é€»è¾‘ç”±ç”¨æˆ·è®¾å®šçš„å¼•å¯¼æ–¹æ³•å†³å®šã€‚

è¿™äº›è°ƒç”¨æŒ‡ä»¤å¯ä»¥æ ¹æ®å¯¹è±¡çš„ç±»å‹å’Œæ–¹æ³•çš„ç‰¹æ€§è¿›è¡Œä¸åŒçš„åˆ†æ´¾å’Œè°ƒç”¨ã€‚

> `invokedynamic` æŒ‡ä»¤æ˜¯åœ¨ JDK 7æ—¶åŠ å…¥åˆ°å­—èŠ‚ç ä¸­çš„ï¼Œå½“æ—¶ç¡®å®åªä¸ºäº†åšåŠ¨æ€è¯­è¨€ï¼ˆå¦‚ JRubyã€Scalaï¼‰æ”¯æŒï¼ŒJava è¯­è¨€æœ¬èº«å¹¶ä¸ä¼šç”¨åˆ°å®ƒã€‚è€Œåˆ°äº†JDK 8 æ—¶ä»£ï¼ŒJava æœ‰äº† Lambda è¡¨è¾¾å¼å’Œæ¥å£çš„é»˜è®¤æ–¹æ³•ï¼Œå®ƒä»¬åœ¨åº•å±‚è°ƒç”¨æ—¶å°±ä¼šç”¨åˆ° `invokedynamic` æŒ‡ä»¤ã€‚

å…¶ä¸­ï¼Œ`invokestatic` å’Œ `invokespecial` æŒ‡ä»¤å¯ä»¥è°ƒç”¨éè™šæ–¹æ³•ï¼ŒåŒ…æ‹¬é™æ€æ–¹æ³•ã€ç§æœ‰æ–¹æ³•ã€å®ä¾‹æ„é€ å™¨å’Œçˆ¶ç±»æ–¹æ³•ã€‚è€Œ `invokevirtual` å’Œ `invokeinterface` æŒ‡ä»¤ç”¨äºè°ƒç”¨è™šæ–¹æ³•ï¼Œæ ¹æ®å¯¹è±¡çš„å®é™…ç±»å‹è¿›è¡Œåˆ†æ´¾ã€‚

ä¹Ÿè®¸è¿™äº›æŒ‡ä»¤çœ‹èµ·æ¥ç®€å•ä½†å¾ˆéš¾ç†è§£ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬åœ¨ä¸Šæ–‡å¤šæ¬¡æåˆ°è¿‡â€œæ–¹æ³•è°ƒç”¨â€ã€â€œè§£æâ€ã€â€œåˆ†æ´¾â€è¿™äº›ä¸œè¥¿ï¼Œåˆ«æ€¥ï¼Œå¦‚æœæƒ³è¦çœŸæ­£å¼„æ¸…æ¥šè¿™äº›æŒ‡ä»¤ï¼Œæˆ‘ä»¬éœ€è¦ä¸€æ­¥æ­¥æ¥ï¼ˆ

****

## æ–¹æ³•è°ƒç”¨æ¦‚è¿°

****

**æ–¹æ³•è°ƒç”¨å¹¶ä¸ç­‰åŒäºæ–¹æ³•ä¸­çš„ä»£ç è¢«æ‰§è¡Œ**ï¼Œæ–¹æ³•è°ƒç”¨é˜¶æ®µå”¯ä¸€çš„ä»»åŠ¡å°±æ˜¯ç¡®å®šè¢«è°ƒç”¨æ–¹æ³•çš„ç‰ˆæœ¬ï¼ˆå³è°ƒç”¨å“ªä¸€ä¸ªæ–¹æ³•ï¼‰ï¼Œæš‚æ—¶è¿˜æœªæ¶‰åŠæ–¹æ³•å†…éƒ¨çš„å…·ä½“è¿è¡Œè¿‡ç¨‹ã€‚

ä¸€åˆ‡æ–¹æ³•è°ƒç”¨åœ¨ `Class` æ–‡ä»¶é‡Œé¢å­˜å‚¨çš„éƒ½åªæ˜¯ç¬¦å·å¼•ç”¨ï¼Œè€Œä¸æ˜¯æ–¹æ³•åœ¨å®é™…è¿è¡Œæ—¶å†…å­˜å¸ƒå±€ä¸­çš„å…¥å£åœ°å€ï¼ˆç›´æ¥å¼•ç”¨ï¼‰ã€‚

è¿™ä¸ªç‰¹æ€§ç»™ `Java` å¸¦æ¥äº†æ›´å¼ºå¤§çš„åŠ¨æ€æ‰©å±•èƒ½åŠ›ï¼Œä½†ä¹Ÿä½¿å¾— `Java` æ–¹æ³•è°ƒç”¨è¿‡ç¨‹å˜å¾—ç›¸å¯¹å¤æ‚ï¼ŒæŸäº›è°ƒç”¨éœ€è¦åœ¨ç±»åŠ è½½æœŸé—´ï¼Œç”šè‡³åˆ°è¿è¡ŒæœŸé—´æ‰èƒ½ç¡®å®šç›®æ ‡æ–¹æ³•çš„ç›´æ¥å¼•ç”¨ã€‚

åœ¨ `Javav`  ä¸­ï¼Œæ–¹æ³•è°ƒç”¨è¿‡ç¨‹ä¸­åŒæ—¶å­˜åœ¨è§£æï¼ˆResolutionï¼‰å’Œåˆ†æ´¾ï¼ˆDispatchï¼‰ä¸¤ä¸ªè¿‡ç¨‹ï¼Œæ–¹æ³•è°ƒç”¨è¿‡ç¨‹ä¸­é¦–å…ˆè¿›è¡Œè§£æï¼Œå°†ç¬¦å·å¼•ç”¨è½¬åŒ–ä¸ºç›´æ¥å¼•ç”¨ï¼Œç„¶åæ ¹æ®å®é™…å¯¹è±¡çš„ç±»å‹è¿›è¡Œåˆ†æ´¾ï¼Œç¡®å®šæ–¹æ³•çš„å®é™…æ‰§è¡Œç‰ˆæœ¬ã€‚

****

## è§£æ

****

è§£æï¼š

* åœ¨ç±»åŠ è½½çš„è§£æé˜¶æ®µå°†æ–¹æ³•è°ƒç”¨çš„ç¬¦å·å¼•ç”¨è½¬åŒ–ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹ã€‚

è§£æçš„å‰æï¼š

* æ–¹æ³•åœ¨ç¨‹åºç¼–å†™ã€ç¼–è¯‘é˜¶æ®µå°±æœ‰ä¸€ä¸ªå¯ç¡®å®šçš„è°ƒç”¨ç‰ˆæœ¬ï¼Œå¹¶ä¸”è¿™ä¸ªç‰ˆæœ¬åœ¨è¿è¡ŒæœŸæ˜¯ä¸å¯æ”¹å˜çš„ã€‚
* å¿…é¡»æ˜¯é™æ€æ–¹æ³•ã€ç§æœ‰æ–¹æ³•å’Œè¢« `final` ä¿®é¥°çš„å®ä¾‹æ–¹æ³•ï¼Œå› ä¸ºå®ƒä»¬éƒ½ä¸å¯èƒ½é€šè¿‡ç»§æ‰¿æˆ–å…¶ä»–æ–¹å¼é‡å†™å‡ºå…¶ä»–ç‰ˆæœ¬ã€‚

è§£æè°ƒç”¨è¿‡ç¨‹ï¼š

* è§£æè°ƒç”¨æ˜¯é™æ€çš„è¿‡ç¨‹ï¼Œ**åœ¨ç¼–è¯‘æœŸé—´å°±å®Œå…¨ç¡®å®š**ï¼Œä¸å»¶è¿Ÿåˆ°è¿è¡ŒæœŸå†å®Œæˆã€‚
* åœ¨ç±»åŠ è½½çš„è§£æé˜¶æ®µï¼Œæ¶‰åŠçš„ç¬¦å·å¼•ç”¨ä¼šè¢«è½¬å˜ä¸ºæ˜ç¡®çš„ç›´æ¥å¼•ç”¨ï¼Œå­˜å‚¨åœ¨å¸¸é‡æ± ä¸­ã€‚

è¿™ç§è½¬åŒ–ä½¿å¾—æ–¹æ³•è°ƒç”¨åœ¨è¿è¡Œæ—¶å¯ä»¥æ›´é«˜æ•ˆåœ°æ‰§è¡Œï¼Œæ— éœ€å†è¿›è¡Œç¬¦å·è§£æï¼Œç›´æ¥ä½¿ç”¨å·²ç»è§£æçš„ç›´æ¥å¼•ç”¨ã€‚

****

## åˆ†æ´¾ï¼ˆé‡ç‚¹ï¼‰

****

`Java` ä½œä¸ºä¸€é—¨é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ï¼Œå…·å¤‡ç»§æ‰¿ã€å°è£…å’Œå¤šæ€è¿™ä¸‰ä¸ªåŸºæœ¬ç‰¹å¾ã€‚

è€Œåˆ†æ´¾è°ƒç”¨è¿‡ç¨‹åœ¨ `Java` è™šæ‹Ÿæœºä¸­æ­ç¤ºäº†å¤šæ€æ€§çš„ä½“ç°ï¼Œç‰¹åˆ«æ˜¯åœ¨æ–¹æ³•çš„é‡è½½å’Œé‡å†™æ–¹é¢ï¼š

1. é‡è½½ï¼ˆOverloadingï¼‰ï¼šé‡è½½æ˜¯æŒ‡åœ¨åŒä¸€ä¸ªç±»ä¸­å®šä¹‰å¤šä¸ªæ–¹æ³•ï¼Œå®ƒä»¬å…·æœ‰ç›¸åŒçš„åç§°ä½†å‚æ•°åˆ—è¡¨ä¸åŒã€‚åœ¨è™šæ‹Ÿæœºä¸­å®ç°é‡è½½æ—¶ï¼Œä¼šæ ¹æ®æ–¹æ³•è°ƒç”¨çš„é™æ€ç±»å‹ï¼ˆå£°æ˜ç±»å‹ï¼‰é€‰æ‹©åˆé€‚çš„æ–¹æ³•ç‰ˆæœ¬ã€‚è¿™å±äºé™æ€åˆ†æ´¾ï¼Œæ ¹æ®å‚æ•°çš„é™æ€ç±»å‹æ¥ç¡®å®šæ–¹æ³•çš„ç‰ˆæœ¬ã€‚

2. é‡å†™ï¼ˆOverridingï¼‰ï¼šé‡å†™æ˜¯æŒ‡å­ç±»é‡æ–°å®šä¹‰çˆ¶ç±»ä¸­å·²æœ‰çš„æ–¹æ³•ï¼Œå…·æœ‰ç›¸åŒçš„åç§°å’Œå‚æ•°åˆ—è¡¨ã€‚åœ¨è™šæ‹Ÿæœºä¸­å®ç°é‡å†™æ—¶ï¼Œä¼šæ ¹æ®æ–¹æ³•è°ƒç”¨çš„å®é™…ç±»å‹ï¼ˆè¿è¡Œæ—¶ç±»å‹ï¼‰é€‰æ‹©åˆé€‚çš„æ–¹æ³•ç‰ˆæœ¬ã€‚è¿™å±äºåŠ¨æ€åˆ†æ´¾ï¼Œæ ¹æ®å®é™…å¯¹è±¡çš„ç±»å‹æ¥ç¡®å®šæ–¹æ³•çš„ç‰ˆæœ¬ã€‚

ä¸‹é¢æˆ‘ä»¬å°±æ¥æ­ç¤º `JVM` å®ç°é‡è½½å’Œé‡å†™çš„åº•å±‚åŸç†ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬çœŸæ­£çš„é‡ç‚¹éƒ¨åˆ†ã€‚

****

### é™æ€åˆ†æ´¾

****

> â€œåˆ†æ´¾â€ï¼ˆDispatchï¼‰è¿™ä¸ªè¯æœ¬èº«å°±å…·æœ‰åŠ¨æ€æ€§ï¼Œä¸€èˆ¬ä¸åº”ç”¨åœ¨é™æ€è¯­å¢ƒä¹‹ä¸­ï¼Œè¿™éƒ¨åˆ†åŸæœ¬åœ¨è‹±æ–‡åŸç‰ˆçš„ã€ŠJavaè™šæ‹Ÿæœºè§„èŒƒã€‹å’Œã€ŠJavaè¯­è¨€è§„èŒƒã€‹é‡Œçš„è¯´æ³•éƒ½æ˜¯â€œMethod Overload Resolutionâ€ï¼Œå³åº”è¯¥å½’å…¥ä¸ŠèŠ‚çš„â€œè§£æâ€é‡Œå»è®²è§£ï¼Œä½†éƒ¨åˆ†å…¶ä»–å¤–æ–‡èµ„æ–™å’Œå›½å†…ç¿»è¯‘çš„è®¸å¤šä¸­æ–‡èµ„æ–™éƒ½å°†è¿™ç§è¡Œä¸ºç§°ä¸ºâ€œé™æ€åˆ†æ´¾â€ã€‚

ä¸ºäº†è§£é‡Šé™æ€åˆ†æ´¾å’Œé‡è½½ï¼Œæˆ‘ä»¬çœ‹å¦‚ä¸‹ç¤ºä¾‹ä»£ç ï¼š

```java
public class StaticDispatch {
    static abstract class Human {
    }

    static class Man extends Human {
    }

    static class Woman extends Human {
    }

    public void sayHello(Human guy) {
        System.out.println("hello,guy!");
    }

    public void sayHello(Man guy) {
        System.out.println("hello,gentleman!");
    }

    public void sayHello(Woman guy) {
        System.out.println("hello,lady!");
    }

    public static void main(String[] args) {
        Human man = new Man();
        Human woman = new Woman();
        StaticDispatch sr = new StaticDispatch();
        sr.sayHello(man);
        sr.sayHello(woman);
    }
}
```

ä¸Šé¢çš„ä»£ç ä¸­å®šä¹‰äº†ä¸€ä¸ª `StaticDispatch` ç±»ï¼ŒåŒ…å«äº†ä¸€ä¸ªæŠ½è±¡ç±» `Human` å’Œä¸¤ä¸ªç»§æ‰¿è‡ª `Human` çš„å­ç±» `Man` å’Œ `Woman`ã€‚ç±»ä¸­å®šä¹‰äº†ä¸‰ä¸ªé‡è½½çš„ `sayHello` æ–¹æ³•ï¼Œåˆ†åˆ«æ¥å— `Human`ã€`Man` å’Œ `Woman` ç±»å‹çš„å‚æ•°ï¼Œå¹¶è¾“å‡ºç›¸åº”çš„é—®å€™è¯­ã€‚

ç†è®ºä¸Šæˆ‘ä»¬é‡è½½äº† `sayHello()` æ–¹æ³•ï¼Œè¿è¡Œç»“æœåº”è¯¥æ˜¯ï¼š

```shell
hello,gentleman!
hello,lady!
```

ä½†å®é™…ä¸Šæ§åˆ¶å°~~å“¼å“¼å“¼å•Šå•Šå•Š~~åœ°è¾“å‡ºäº†ï¼š

```shell
hello, guy!
hello, guy!
```

ä½ å…ˆåˆ«æ€¥ï¼Œè®©æˆ‘å…ˆæ€¥ ğŸ¤¡

è¿™é‡Œæˆ‘ä»¬ä»éœ€è¦å…ˆæå‡ºå‡ ä¸ªæ¦‚å¿µï¼š

- é™æ€ç±»å‹ï¼ˆStatic Typeï¼‰ï¼šåœ¨ç¼–è¯‘æ—¶å·²çŸ¥çš„å˜é‡ç±»å‹ï¼Œç¼–è¯‘å™¨æ ¹æ®é™æ€ç±»å‹è¿›è¡Œæ–¹æ³•çš„é€‰æ‹©å’Œç±»å‹æ£€æŸ¥ã€‚
- å®é™…ç±»å‹ï¼ˆActual Typeï¼‰ï¼šåœ¨ç¨‹åºè¿è¡Œæ—¶ç¡®å®šçš„å˜é‡ç±»å‹ï¼Œç”±å¯¹è±¡çš„å®é™…åˆ›å»ºç±»å‹å†³å®šã€‚

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ`Human` æ˜¯é™æ€ç±»å‹ï¼ˆä¹Ÿå«å¤–è§‚ç±»å‹ï¼‰ï¼Œè€Œ `Man` å’Œ `Woman` åˆ™æ˜¯å®é™…ç±»å‹ï¼ˆä¹Ÿå«è¿è¡Œæ—¶ç±»å‹ï¼‰ã€‚

æˆ‘ä»¬ç”¨ `javap` æŸ¥çœ‹åç¼–è¯‘ç»“æœï¼š

```java
Compiled from "StaticDispatch.java"
public class StaticDispatch {
  public StaticDispatch();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: return

  public void sayHello(StaticDispatch$Human);
    Code:
       0: getstatic     #7                  // Field java/lang/System.out:Ljava/io/PrintStream;
       3: ldc           #13                 // String hello,guy!
       5: invokevirtual #15                 // Method java/io/PrintStream.println:(Ljava/lang/String;)V
       8: return

  public void sayHello(StaticDispatch$Man);
    Code:
       0: getstatic     #7                  // Field java/lang/System.out:Ljava/io/PrintStream;
       3: ldc           #21                 // String hello,gentleman!
       5: invokevirtual #15                 // Method java/io/PrintStream.println:(Ljava/lang/String;)V
       8: return

  public void sayHello(StaticDispatch$Woman);
    Code:
       0: getstatic     #7                  // Field java/lang/System.out:Ljava/io/PrintStream;
       3: ldc           #23                 // String hello,lady!
       5: invokevirtual #15                 // Method java/io/PrintStream.println:(Ljava/lang/String;)V
       8: return

  public static void main(java.lang.String[]);
    Code:
       0: new           #25                 // class StaticDispatch$Man
       3: dup
       4: invokespecial #27                 // Method StaticDispatch$Man."<init>":()V
       7: astore_1
       8: new           #28                 // class StaticDispatch$Woman
      11: dup
      12: invokespecial #30                 // Method StaticDispatch$Woman."<init>":()V
      15: astore_2
      16: new           #31                 // class StaticDispatch
      19: dup
      20: invokespecial #33                 // Method "<init>":()V
      23: astore_3
      24: aload_3
      25: aload_1
      26: invokevirtual #34                 // Method sayHello:(LStaticDispatch$Human;)V
      29: aload_3
      30: aload_2
      31: invokevirtual #34                 // Method sayHello:(LStaticDispatch$Human;)V
      34: return
}
```

å¯ä»¥æ˜æ˜¾åœ°çœ‹åˆ° `main` æ–¹æ³•é‡Œé¢çš„ `26` å’Œ `31` æ˜¯æˆ‘ä»¬çš„æ–¹æ³•è°ƒç”¨ï¼š

```java
26: invokevirtual #34                 // Method sayHello:(LStaticDispatch$Human;)V
......
31: invokevirtual #34                 // Method sayHello:(LStaticDispatch$Human;)V
```

åç¼–è¯‘ç»“æœå·²ç»æŒ‡æ˜äº†ï¼Œå°½ç®¡ `invokevirtual` å¯ä»¥æ ¹æ®å¯¹è±¡çš„å®é™…ç±»å‹è¿›è¡ŒåŠ¨æ€åˆ†æ´¾ï¼Œä½†åœ¨é™æ€åˆ†æ´¾çš„æƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨å·²ç»ç¡®å®šäº†è¦è°ƒç”¨çš„æ–¹æ³•ï¼Œå› æ­¤ä¸ä¼šè¿›è¡ŒåŠ¨æ€åˆ†æ´¾ï¼Œè€Œæ˜¯ç›´æ¥è°ƒç”¨ç¼–è¯‘æ—¶é€‰æ‹©çš„æ–¹æ³•ã€‚

å³ï¼Œ**åœ¨é™æ€åˆ†æ´¾çš„è§„åˆ™ä¸‹ï¼Œæ–¹æ³•çš„é€‰æ‹©æ˜¯åŸºäºå‚æ•°çš„é™æ€ç±»å‹ï¼Œè€Œä¸æ˜¯å®é™…è¿è¡Œæ—¶çš„ç±»å‹**ã€‚

è¿™æ ·ä¹Ÿå°±ä¸éš¾ç†è§£äº†ï¼Œç”±äº `man` å’Œ `woman` çš„é™æ€ç±»å‹éƒ½æ˜¯ `Human`ï¼Œæ‰€ä»¥ä¼šè°ƒç”¨ `Human` çš„ `sayHello()` æ–¹æ³•ã€‚

ä½†å¦‚æœæˆ‘ä»¬å¯¹åŸä»£ç ç¨ä½œä¿®æ”¹ï¼š

```java
public static void main(String[] args) {
        Human man = new Man();
        Human woman = new Woman();
        StaticDispatch sr = new StaticDispatch();
        sr.sayHello((Man) man);  
        sr.sayHello((Woman) woman);
}
```

å†æ¬¡ç¼–è¯‘è¿è¡Œï¼Œå¯ä»¥çœ‹åˆ°ç»“æœå¦‚ä¸‹ï¼š

```shell
hello,gentleman!
hello,lady!
```

æˆ‘ä»¬ç”¨ `javap` æŸ¥çœ‹åç¼–è¯‘ç»“æœï¼š

```java
26: checkcast     #25                 // class StaticDispatch$Man
29: invokevirtual #34                 // Method sayHello:(LStaticDispatch$Man;)V
......
34: checkcast     #28                 // class StaticDispatch$Woman
37: invokevirtual #38                 // Method sayHello:(LStaticDispatch$Woman;)V
```

å¯ä»¥çœ‹åˆ°åœ¨è°ƒç”¨æ–¹æ³•ä¹‹å‰ï¼Œå…ˆè¿›è¡Œäº† `checkcast` æ£€æŸ¥ï¼Œç¡®è®¤äº† `man` å’Œ `woman` å¼ºåˆ¶è½¬æ¢ä¸ºäº†å¯¹åº”çš„å®é™…ç±»å‹ï¼Œè¿™æ ·åœ¨ `invokevirtual` æŒ‡ä»¤è¿›è¡Œæ–¹æ³•è°ƒç”¨æ—¶ï¼ŒæŒ‡å‘çš„å°±æ˜¯å¯¹åº”å®é™…ç±»å‹çš„ `sayHello()` æ–¹æ³•äº†ã€‚é€šè¿‡è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œå³ä½¿åœ¨é™æ€ç±»å‹å·²ç»ç¡®å®šçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä»ç»•è¿‡äº†é™æ€åˆ†æ´¾çš„è§„åˆ™ï¼Œä½¿å¾—æ–¹æ³•çš„é€‰æ‹©åŸºäºå®é™…ç±»å‹è€Œä¸æ˜¯é™æ€ç±»å‹ã€‚

****

### åŠ¨æ€åˆ†æ´¾

****

åŠ¨æ€åˆ†æ´¾ï¼ˆDynamic Dispatchï¼‰æ˜¯ä¸€ç§åœ¨è¿è¡Œæ—¶æ ¹æ®å¯¹è±¡çš„å®é™…ç±»å‹æ¥é€‰æ‹©è°ƒç”¨çš„æ–¹æ³•çš„æœºåˆ¶ï¼Œå®ƒä¸ `Java` è¯­è¨€å¤šæ€æ€§çš„å¦å¤–ä¸€ä¸ªé‡è¦ä½“ç°â€”â€”é‡å†™ï¼ˆOverrideï¼‰æœ‰ç€å¾ˆå¯†åˆ‡çš„å…³è”ã€‚

æˆ‘ä»¬å°†ä¸ŠèŠ‚ç¤ºä¾‹ä»£ç ç¨ä½œä¿®æ”¹ï¼š

```java
public class DynamicDispatch {
    static abstract class Human {
        protected abstract void sayHello();
    }
    static class Man extends Human {
        @Override
        protected void sayHello() {
            System.out.println("man say hello");
        }
    }
    static class Woman extends Human {
        @Override
        protected void sayHello() {
            System.out.println("woman say hello");
        }
    }
    public static void main(String[] args) {
        Human man = new Man();
        Human woman = new Woman();
        man.sayHello();
        woman.sayHello();
        man = new Woman();
        man.sayHello();
    }
}
```

åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œ`Human` æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå…¶ä¸­å£°æ˜äº†ä¸€ä¸ªæŠ½è±¡æ–¹æ³• `sayHello()`ï¼Œ`Man` å’Œ `Woman` ç±»éƒ½æ˜¯ `Human` ç±»çš„å­ç±»ï¼Œå®ƒä»¬åˆ†åˆ«é‡å†™äº† `sayHello()` æ–¹æ³•ã€‚æˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº† `Man` å’Œ `Woman` çš„å®ä¾‹å¯¹è±¡ `man` å’Œ `woman` å¹¶è°ƒç”¨äº†ç›¸åº”çš„ `sayHello()` æ–¹æ³•ï¼Œç„¶åè®© `man` é‡æ–°èµ‹å€¼ä¸º `Woman` çš„å®ä¾‹ï¼Œå¹¶è°ƒç”¨å…¶ `sayHello()` æ–¹æ³•ã€‚

ç†è®ºä¸Šè¿è¡Œç»“æœåº”è¯¥ä¸ºï¼š

```shell
man say hello
woman say hello
woman say hello
```

å®é™…ä¸Šï¼š

```shell
man say hello
woman say hello
woman say hello
```

è¿™ä¸ªè¿è¡Œç»“æœç›¸ä¿¡ä¸ä¼šå‡ºä¹ä»»ä½•äººçš„æ„æ–™ ğŸ¤—

å¯¹äºä¹ æƒ¯äº†é¢å‘å¯¹è±¡æ€ç»´çš„æˆ‘ä»¬æ¥è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªç†æ‰€åº”å½“çš„ç»“æœï¼Œä½†é—®é¢˜åœ¨äº `Java` è™šæ‹Ÿæœºæ˜¯å¦‚ä½•æ ¹æ®å®é™…ç±»å‹æ¥åˆ†æ´¾æ–¹æ³•æ‰§è¡Œç‰ˆæœ¬çš„å‘¢ï¼Ÿ

æˆ‘ä»¬ç»§ç»­ç”¨ `javap` å¤§æ³•æŸ¥çœ‹åç¼–è¯‘ç»“æœï¼š

```java
Compiled from "DynamicDispatch.java"
public class DynamicDispatch {
  public DynamicDispatch();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: return

  public static void main(java.lang.String[]);
    Code:
       0: new           #7                  // class DynamicDispatch$Man
       3: dup
       4: invokespecial #9                  // Method DynamicDispatch$Man."<init>":()V
       7: astore_1
       8: new           #10                 // class DynamicDispatch$Woman
      11: dup
      12: invokespecial #12                 // Method DynamicDispatch$Woman."<init>":()V
      15: astore_2
      16: aload_1
      17: invokevirtual #13                 // Method DynamicDispatch$Human.sayHello:()V
      20: aload_2
      21: invokevirtual #13                 // Method DynamicDispatch$Human.sayHello:()V
      24: new           #10                 // class DynamicDispatch$Woman
      27: dup
      28: invokespecial #12                 // Method DynamicDispatch$Woman."<init>":()V
      31: astore_1
      32: aload_1
      33: invokevirtual #13                 // Method DynamicDispatch$Human.sayHello:()V
      36: return
}
```

åœ¨ `main` æ–¹æ³•ä¸­ï¼š

```java
Human man = new Man();
Human woman = new Woman();
```

å¯¹åº”å­—èŠ‚ç æŒ‡ä»¤ä¸ºï¼š

```java
 0: new           #7                  // class DynamicDispatch$Man
 3: dup
 4: invokespecial #9                  // Method DynamicDispatch$Man."<init>":()V
 7: astore_1
 8: new           #10                 // class DynamicDispatch$Woman
11: dup
12: invokespecial #12                 // Method DynamicDispatch$Woman."<init>":()V
15: astore_2
```

è€Œè°ƒç”¨æ–¹æ³•ï¼š

```java
man.sayHello();
woman.sayHello();
```

å¯¹åº”å­—èŠ‚ç æŒ‡ä»¤ä¸ºï¼š

```java
17: invokevirtual #13                 // Method DynamicDispatch$Human.sayHello:()V
......
21: invokevirtual #13                 // Method DynamicDispatch$Human.sayHello:()V
```

å¯ä»¥çœ‹åˆ° `invokevirtual` æŒ‡ä»¤æ³¨é‡Šå·²ç»æ˜¾ç¤ºäº†è¿™ä¸ªå¸¸é‡æ˜¯ `DynamicDispatch` ç±»ä¸‹ `Human.sayHello()`çš„ç¬¦å·å¼•ç”¨ï¼Œä½†æ˜¯è¿™ä¸¤å¥æŒ‡ä»¤æœ€ç»ˆæ‰§è¡Œçš„ç›®æ ‡æ–¹æ³•å¹¶ä¸ç›¸åŒã€‚

æˆ‘ä»¬ä» `invokevirtual` æŒ‡ä»¤æœ¬èº«å…¥æ‰‹ï¼Œå…¶è¿è¡Œæ—¶è§£æè¿‡ç¨‹å¤§è‡´åˆ†ä¸ºä»¥ä¸‹å‡ æ­¥ï¼š

- æ‰¾åˆ°æ“ä½œæ•°æ ˆé¡¶çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ‰€æŒ‡å‘çš„å¯¹è±¡çš„å®é™…ç±»å‹ ï¼Œè®°ä½œ $C$ã€‚
- å¦‚æœåœ¨ç±»å‹ $C$ ä¸­æ‰¾åˆ°ä¸å¸¸é‡ä¸­çš„æè¿°ç¬¦å’Œç®€å•åç§°éƒ½ç›¸ç¬¦çš„æ–¹æ³•ï¼Œåˆ™è¿›è¡Œè®¿é—®æƒé™æ ¡éªŒï¼Œå¦‚æœé€šè¿‡åˆ™è¿”å›è¿™ä¸ªæ–¹æ³•çš„ç›´æ¥å¼•ç”¨ï¼ŒæŸ¥æ‰¾è¿‡ç¨‹ç»“æŸï¼›ä¸é€šè¿‡åˆ™è¿”å› `java.lang.IllegalAccessError` å¼‚å¸¸ã€‚
- å¦åˆ™ï¼ŒæŒ‰ç…§ç»§æ‰¿å…³ç³»ä»ä¸‹å¾€ä¸Šä¾æ¬¡å¯¹ $C$ çš„å„ä¸ªçˆ¶ç±»è¿›è¡Œç¬¬äºŒæ­¥çš„æœç´¢å’ŒéªŒè¯è¿‡ç¨‹ã€‚
- å¦‚æœå§‹ç»ˆæ²¡æœ‰æ‰¾åˆ°åˆé€‚çš„æ–¹æ³•ï¼Œåˆ™æŠ›å‡º `java.lang.AbstractMethodError` å¼‚å¸¸ã€‚

å› æ­¤ï¼Œ`invokevirtual` æŒ‡ä»¤åœ¨æ‰§è¡Œæ—¶ä¼šå…ˆç¡®å®šæ¥æ”¶è€…çš„å®é™…ç±»å‹ï¼Œæ‰€ä»¥ä¸¤æ¬¡è°ƒç”¨ä¸­çš„ `invokevirtual` æŒ‡ä»¤å¹¶ä¸æ˜¯æŠŠå¸¸é‡æ± ä¸­æ–¹æ³•çš„ç¬¦å·å¼•ç”¨è§£æåˆ°ç›´æ¥å¼•ç”¨ä¸Šå°±ç»“æŸäº†ï¼Œè¿˜ä¼šæ ¹æ®æ–¹æ³•æ¥æ”¶è€…çš„å®é™…ç±»å‹æ¥é€‰æ‹©æ–¹æ³•ç‰ˆæœ¬ã€‚

****

### å•åˆ†æ´¾ä¸å¤šåˆ†æ´¾

****

æ–¹æ³•çš„æ¥æ”¶è€…ä¸æ–¹æ³•çš„å‚æ•°ç»Ÿç§°ä¸ºæ–¹æ³•çš„å®—é‡ï¼Œæ ¹æ®åˆ†æ´¾åŸºäºå¤šå°‘ç§å®—é‡ï¼Œå¯ä»¥å°†åˆ†æ´¾åˆ’åˆ†ä¸ºå•åˆ†æ´¾å’Œå¤šåˆ†æ´¾ä¸¤ç§ï¼š

1. å•åˆ†æ´¾æŒ‡çš„æ˜¯æ ¹æ®æ–¹æ³•è°ƒç”¨çš„æ¥æ”¶è€…çš„ç±»å‹æ¥ç¡®å®šä½¿ç”¨å“ªä¸ªæ–¹æ³•å®ç°ã€‚
   - åœ¨å•åˆ†æ´¾ä¸­ï¼Œæ–¹æ³•çš„é€‰æ‹©ä»…ä»…ä¾èµ–äºæ¥æ”¶è€…çš„ç±»å‹ï¼Œä¸è€ƒè™‘æ–¹æ³•å‚æ•°çš„ç±»å‹ã€‚
2. å¤šåˆ†æ´¾æŒ‡çš„æ˜¯æ ¹æ®æ–¹æ³•è°ƒç”¨çš„æ¥æ”¶è€…å’Œå‚æ•°çš„ç±»å‹æ¥ç¡®å®šä½¿ç”¨å“ªä¸ªæ–¹æ³•å®ç°ã€‚
   - åœ¨å¤šåˆ†æ´¾ä¸­ï¼Œæ–¹æ³•çš„é€‰æ‹©ä¸ä»…ä¾èµ–äºæ¥æ”¶è€…çš„ç±»å‹ï¼Œè¿˜ä¾èµ–äºæ–¹æ³•å‚æ•°çš„ç±»å‹ã€‚

å¯¹äº `Java` æ¥è¯´ï¼š

- é™æ€åˆ†æ´¾æ ¹æ®æ–¹æ³•è°ƒç”¨æ—¶çš„é™æ€ç±»å‹å’Œå‚æ•°çš„é™æ€ç±»å‹æ¥é€‰æ‹©ç›®æ ‡æ–¹æ³•ï¼Œå±äºå¤šåˆ†æ´¾ã€‚
- åœ¨åŠ¨æ€åˆ†æ ¹æ®æ–¹æ³•è°ƒç”¨æ—¶çš„å®é™…ç±»å‹æ¥é€‰æ‹©ç›®æ ‡æ–¹æ³•ï¼Œå±äºå•åˆ†æ´¾ã€‚

****

## invokedynamic

****

`JDK 7` ä¸ºäº†æ›´å¥½åœ°æ”¯æŒåŠ¨æ€ç±»å‹è¯­è¨€ï¼Œå¼•å…¥äº†ç¬¬äº”æ¡æ–¹æ³•è°ƒç”¨çš„å­—èŠ‚ç æŒ‡ä»¤ `invokedynamic`ï¼Œå¦‚æœä½ çœ‹è¿‡æˆ‘ä¹‹å‰å†™è¿‡çš„[æµ…è°ˆ Java ä¸­çš„ Lambda è¡¨è¾¾å¼](https://lys2021.com/?p=1544)ï¼Œå…¶ä¸­åœ¨ `Lambda` çš„æœ¬è´¨ä¸€èŠ‚æˆ‘ä¹Ÿæåˆ°äº†å®ƒï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬å¥½å¥½åº·åº·åˆ°åº•æ€ä¹ˆä¸ªäº‹ï¼ˆ

æˆ‘ä»¬æ²¿ç”¨å…¶ä¸­çš„ç¤ºä¾‹ï¼š

```java
public class LambdaTest {

    public static interface Test {
        String showTestNumber(Integer param);
    }

    public static void main(String[] args) {
        Test test = param -> "Test number is " + param;
        System.out.println(test.showTestNumber(114514));
    }
}
```

`javac` ç¼–è¯‘åå† `javap` åç¼–è¯‘å›å»å¾—åˆ°ä¸‹é¢çš„å†…å®¹ï¼š

```java
Classfile /L:/JAVA/BasicSyntax/Learn_JVM/code/LambdaTest.class
  Last modified 2023å¹´9æœˆ6æ—¥; size 1445 bytes
  SHA-256 checksum 3a71d05fe531173bda2fd05e7b9a5a12dc0fd040047f87a59add471744a6a2be
  Compiled from "LambdaTest.java"
public class LambdaTest
  minor version: 0
  major version: 61
  flags: (0x0021) ACC_PUBLIC, ACC_SUPER
  this_class: #38                         // LambdaTest
  super_class: #2                         // java/lang/Object
  interfaces: 0, fields: 0, methods: 3, attributes: 4
Constant pool:
   #1 = Methodref          #2.#3          // java/lang/Object."<init>":()V
   #2 = Class              #4             // java/lang/Object
   #3 = NameAndType        #5:#6          // "<init>":()V
   #4 = Utf8               java/lang/Object
   #5 = Utf8               <init>
   #6 = Utf8               ()V
   #7 = InvokeDynamic      #0:#8          // #0:showTestNumber:()LLambdaTest$Test;
   #8 = NameAndType        #9:#10         // showTestNumber:()LLambdaTest$Test;
   #9 = Utf8               showTestNumber
  #10 = Utf8               ()LLambdaTest$Test;
  #11 = Fieldref           #12.#13        // java/lang/System.out:Ljava/io/PrintStream;
  #12 = Class              #14            // java/lang/System
  #13 = NameAndType        #15:#16        // out:Ljava/io/PrintStream;
  #14 = Utf8               java/lang/System
  #15 = Utf8               out
  #16 = Utf8               Ljava/io/PrintStream;
  #17 = Integer            114514
  #18 = Methodref          #19.#20        // java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
  #19 = Class              #21            // java/lang/Integer
  #20 = NameAndType        #22:#23        // valueOf:(I)Ljava/lang/Integer;
  #21 = Utf8               java/lang/Integer
  #22 = Utf8               valueOf
  #23 = Utf8               (I)Ljava/lang/Integer;
  #24 = InterfaceMethodref #25.#26        // LambdaTest$Test.showTestNumber:(Ljava/lang/Integer;)Ljava/lang/String;
  #25 = Class              #27            // LambdaTest$Test
  #26 = NameAndType        #9:#28         // showTestNumber:(Ljava/lang/Integer;)Ljava/lang/String;
  #27 = Utf8               LambdaTest$Test
  #28 = Utf8               (Ljava/lang/Integer;)Ljava/lang/String;
  #29 = Methodref          #30.#31        // java/io/PrintStream.println:(Ljava/lang/String;)V
  #30 = Class              #32            // java/io/PrintStream
  #31 = NameAndType        #33:#34        // println:(Ljava/lang/String;)V
  #32 = Utf8               java/io/PrintStream
  #33 = Utf8               println
  #34 = Utf8               (Ljava/lang/String;)V
  #35 = InvokeDynamic      #1:#36         // #1:makeConcatWithConstants:(Ljava/lang/Integer;)Ljava/lang/String;
  #36 = NameAndType        #37:#28        // makeConcatWithConstants:(Ljava/lang/Integer;)Ljava/lang/String;
  #37 = Utf8               makeConcatWithConstants
  #38 = Class              #39            // LambdaTest
  #39 = Utf8               LambdaTest
  #40 = Utf8               Code
  #41 = Utf8               LineNumberTable
  #42 = Utf8               main
  #43 = Utf8               ([Ljava/lang/String;)V
  #44 = Utf8               lambda$main$0
  #45 = Utf8               SourceFile
  #46 = Utf8               LambdaTest.java
  #47 = Utf8               NestMembers
  #48 = Utf8               BootstrapMethods
  #49 = MethodHandle       6:#50          // REF_invokeStatic java/lang/invoke/LambdaMetafactory.metafactory:(Ljava/lang/invoke/MethodHandles$Lookup;Ljava/lang/String;Ljava/lang/invoke/MethodType;Ljava/lang/invoke/MethodType;Ljava/lang/invoke/MethodHandle;Ljava/lang/invoke/MethodType;)Ljava/lang/invoke/CallSite;
  #50 = Methodref          #51.#52        // java/lang/invoke/LambdaMetafactory.metafactory:(Ljava/lang/invoke/MethodHandles$Lookup;Ljava/lang/String;Ljava/lang/invoke/MethodType;Ljava/lang/invoke/MethodType;Ljava/lang/invoke/MethodHandle;Ljava/lang/invoke/MethodType;)Ljava/lang/invoke/CallSite;
  #51 = Class              #53            // java/lang/invoke/LambdaMetafactory
  #52 = NameAndType        #54:#55        // metafactory:(Ljava/lang/invoke/MethodHandles$Lookup;Ljava/lang/String;Ljava/lang/invoke/MethodType;Ljava/lang/invoke/MethodType;Ljava/lang/invoke/MethodHandle;Ljava/lang/invoke/MethodType;)Ljava/lang/invoke/CallSite;
  #53 = Utf8               java/lang/invoke/LambdaMetafactory
  #54 = Utf8               metafactory
  #55 = Utf8               (Ljava/lang/invoke/MethodHandles$Lookup;Ljava/lang/String;Ljava/lang/invoke/MethodType;Ljava/lang/invoke/MethodType;Ljava/lang/invoke/MethodHandle;Ljava/lang/invoke/MethodType;)Ljava/lang/invoke/CallSite;
  #56 = MethodType         #28            //  (Ljava/lang/Integer;)Ljava/lang/String;
  #57 = MethodHandle       6:#58          // REF_invokeStatic LambdaTest.lambda$main$0:(Ljava/lang/Integer;)Ljava/lang/String;
  #58 = Methodref          #38.#59        // LambdaTest.lambda$main$0:(Ljava/lang/Integer;)Ljava/lang/String;
  #59 = NameAndType        #44:#28        // lambda$main$0:(Ljava/lang/Integer;)Ljava/lang/String;
  #60 = MethodHandle       6:#61          // REF_invokeStatic java/lang/invoke/StringConcatFactory.makeConcatWithConstants:(Ljava/lang/invoke/MethodHandles$Lookup;Ljava/lang/String;Ljava/lang/invoke/MethodType;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/invoke/CallSite;
  #61 = Methodref          #62.#63        // java/lang/invoke/StringConcatFactory.makeConcatWithConstants:(Ljava/lang/invoke/MethodHandles$Lookup;Ljava/lang/String;Ljava/lang/invoke/MethodType;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/invoke/CallSite;
  #62 = Class              #64            // java/lang/invoke/StringConcatFactory
  #63 = NameAndType        #37:#65        // makeConcatWithConstants:(Ljava/lang/invoke/MethodHandles$Lookup;Ljava/lang/String;Ljava/lang/invoke/MethodType;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/invoke/CallSite;
  #64 = Utf8               java/lang/invoke/StringConcatFactory
  #65 = Utf8               (Ljava/lang/invoke/MethodHandles$Lookup;Ljava/lang/String;Ljava/lang/invoke/MethodType;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/invoke/CallSite;
  #66 = String             #67            // Test number is \u0001
  #67 = Utf8               Test number is \u0001
  #68 = Utf8               InnerClasses
  #69 = Utf8               Test
  #70 = Class              #71            // java/lang/invoke/MethodHandles$Lookup
  #71 = Utf8               java/lang/invoke/MethodHandles$Lookup
  #72 = Class              #73            // java/lang/invoke/MethodHandles
  #73 = Utf8               java/lang/invoke/MethodHandles
  #74 = Utf8               Lookup
{
  public LambdaTest();
    descriptor: ()V
    flags: (0x0001) ACC_PUBLIC
    Code:
      stack=1, locals=1, args_size=1
         0: aload_0
         1: invokespecial #1                  // Method java/lang/Object."<init>":()V
         4: return
      LineNumberTable:
        line 1: 0

  public static void main(java.lang.String[]);
    descriptor: ([Ljava/lang/String;)V
    flags: (0x0009) ACC_PUBLIC, ACC_STATIC
    Code:
      stack=3, locals=2, args_size=1
         0: invokedynamic #7,  0              // InvokeDynamic #0:showTestNumber:()LLambdaTest$Test;
         5: astore_1
         6: getstatic     #11                 // Field java/lang/System.out:Ljava/io/PrintStream;
         9: aload_1
        10: ldc           #17                 // int 114514
        12: invokestatic  #18                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
        15: invokeinterface #24,  2           // InterfaceMethod LambdaTest$Test.showTestNumber:(Ljava/lang/Integer;)Ljava/lang/String;
        20: invokevirtual #29                 // Method java/io/PrintStream.println:(Ljava/lang/String;)V
        23: return
      LineNumberTable:
        line 8: 0
        line 9: 6
        line 10: 23
}
SourceFile: "LambdaTest.java"
NestMembers:
  LambdaTest$Test
BootstrapMethods:
  0: #49 REF_invokeStatic java/lang/invoke/LambdaMetafactory.metafactory:(Ljava/lang/invoke/MethodHandles$Lookup;Ljava/lang/String;Ljava/lang/invoke/MethodType;Ljava/lang/invoke/MethodType;Ljava/lang/invoke/MethodHandle;Ljava/lang/invoke/MethodType;)Ljava/lang/invoke/CallSite;
    Method arguments:
      #56 (Ljava/lang/Integer;)Ljava/lang/String;
      #57 REF_invokeStatic LambdaTest.lambda$main$0:(Ljava/lang/Integer;)Ljava/lang/String;
      #56 (Ljava/lang/Integer;)Ljava/lang/String;
  1: #60 REF_invokeStatic java/lang/invoke/StringConcatFactory.makeConcatWithConstants:(Ljava/lang/invoke/MethodHandles$Lookup;Ljava/lang/String;Ljava/lang/invoke/MethodType;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/invoke/CallSite;
    Method arguments:
      #66 Test number is \u0001
InnerClasses:
  public static #69= #25 of #38;          // Test=class LambdaTest$Test of class LambdaTest
  public static final #74= #70 of #72;    // Lookup=class java/lang/invoke/MethodHandles$Lookup of class java/lang/invoke/MethodHandles
```

æˆ‘ä»¬è¿˜æ˜¯é‡ç‚¹çŒæ³¨ `main` æ–¹æ³•é‡Œé¢çš„å†…å®¹ï¼š

```java
public static void main(java.lang.String[]);
    descriptor: ([Ljava/lang/String;)V
    flags: (0x0009) ACC_PUBLIC, ACC_STATIC
    Code:
      stack=3, locals=2, args_size=1
         0: invokedynamic #7,  0              // InvokeDynamic #0:showTestNumber:()LLambdaTest$Test;
         5: astore_1
         6: getstatic     #11                 // Field java/lang/System.out:Ljava/io/PrintStream;
         9: aload_1
        10: ldc           #17                 // int 114514
        12: invokestatic  #18                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
        15: invokeinterface #24,  2           // InterfaceMethod LambdaTest$Test.showTestNumber:(Ljava/lang/Integer;)Ljava/lang/String;
        20: invokevirtual #29                 // Method java/io/PrintStream.println:(Ljava/lang/String;)V
        23: return
      LineNumberTable:
        line 8: 0
        line 9: 6
        line 10: 23
}
```

å…¶ä¸­ï¼š

```java
0: invokedynamic #7,  0              // InvokeDynamic #0:showTestNumber:()LLambdaTest$Test;
```

å°±å¯¹åº”äº†æˆ‘ä»¬çš„ï¼š

```java
Test test = param -> "Test number is " + param;
```

ä¸‹é¢æˆ‘ä»¬æ¥å…·ä½“å±•ç¤º `invokedynamic` æŒ‡ä»¤çš„è¿ä½œè¿‡ç¨‹ï¼š

1. `0: invokedynamic #7,  0` æç¤ºæˆ‘ä»¬éœ€è¦æ‰¾åˆ°å¸¸é‡æ± ä¸­ç´¢å¼•ä¸º `#7` çš„ `InvokeDynamic` é¡¹ã€‚æ ¹æ®åç¼–è¯‘ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°è¿™ä¸ªé¡¹çš„æè¿°ç¬¦ä¸º `#0:showTestNumber:()LLambdaTest$Test;`ï¼Œè¿™ä¹Ÿæ˜¯ `javap -v` é¢„å…ˆæ·»åŠ çš„æ³¨é‡Šå†…å®¹ã€‚
2. æ¥ä¸‹æ¥ `#7` åé¢ç´§è·Ÿçš„ `0` æ˜¯æˆ‘ä»¬éœ€è¦å¯»æ‰¾çš„è§£æå¼•å¯¼æ–¹æ³•ï¼Œå³æœ€åçš„ `BootstrapMethods` ä¸­å€¼ä¸º `0` çš„å†…å®¹ï¼Œå…¶å¼•å¯¼æ–¹æ³•æè¿°ç¬¦æŒ‡å‘äº† `LambdaMetafactory.metafactory` æ–¹æ³•ã€‚
3. ç»§ç»­æ‰§è¡Œå¼•å¯¼æ–¹æ³• `#49`ï¼šè¡¨ç¤ºè°ƒç”¨çš„é™æ€æ–¹æ³• `LambdaMetafactory.metafactory` æ¥å—å…­ä¸ªå‚æ•°å¹¶è¿”å›ä¸€ä¸ª`CallSite`å¯¹è±¡ï¼Œå‚æ•°å¦‚ä¸‹ï¼š
   - `java/lang/invoke/MethodHandles$Lookup`ï¼šè¡¨ç¤ºä¸€ä¸ª`MethodHandles.Lookup`å¯¹è±¡ï¼Œç”¨äºæŸ¥æ‰¾è¦è°ƒç”¨çš„æ–¹æ³•
   - `java/lang/String`ï¼šè¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”¨äºæŒ‡å®šè¦å®ç°çš„å‡½æ•°æ¥å£çš„åç§°ã€‚
   - `java/lang/invoke/MethodType`ï¼šè¡¨ç¤ºä¸€ä¸ªæ–¹æ³•ç±»å‹å¯¹è±¡ï¼ŒæŒ‡å®šè¦å®ç°çš„å‡½æ•°æ¥å£çš„æ–¹æ³•ç­¾åã€‚
   - `java/lang/invoke/MethodType`ï¼šè¡¨ç¤ºä¸€ä¸ªæ–¹æ³•ç±»å‹å¯¹è±¡ï¼ŒæŒ‡å®šè¦å®ç°çš„å‡½æ•°æ¥å£çš„æ–¹æ³•ç­¾åã€‚
   - `java/lang/invoke/MethodHandle`ï¼šè¡¨ç¤ºä¸€ä¸ªæ–¹æ³•å¥æŸ„ï¼ŒæŒ‡å‘è¦è°ƒç”¨çš„æ–¹æ³•ã€‚
   - `java/lang/invoke/MethodType`ï¼šè¡¨ç¤ºä¸€ä¸ªæ–¹æ³•ç±»å‹å¯¹è±¡ï¼ŒæŒ‡å®šè¦è°ƒç”¨çš„æ–¹æ³•çš„æ–¹æ³•ç­¾åã€‚
4. æˆåŠŸè¿”å›åï¼Œå°† `CallSite` å¯¹è±¡ä¸ç›®æ ‡æ–¹æ³•è¿›è¡Œç»‘å®šï¼Œè¯¥æ–¹æ³•æœ‰ä¸‰ä¸ªå‚æ•°ï¼š
   - `#56`ï¼šæ˜¯ä¸€ä¸ªæ–¹æ³•ç±»å‹ï¼ˆ`Ljava/lang/invoke/MethodType`ï¼‰çš„å‚æ•°ï¼Œè¡¨ç¤ºè¢«è°ƒç”¨æ–¹æ³•çš„å‚æ•°ç±»å‹å’Œè¿”å›ç±»å‹ã€‚
   - `#57`ï¼šæ˜¯ä¸€ä¸ªæ–¹æ³•å¥æŸ„ï¼ˆ`Ljava/lang/invoke/MethodHandle`ï¼‰çš„å‚æ•°ï¼Œè¡¨ç¤ºè¦è°ƒç”¨çš„æ–¹æ³•çš„å¥æŸ„ã€‚
   - `#56`ï¼šæ˜¯ä¸€ä¸ªæ–¹æ³•ç±»å‹ï¼ˆ`Ljava/lang/invoke/MethodType`ï¼‰çš„å‚æ•°ï¼Œè¡¨ç¤ºè¢«è°ƒç”¨æ–¹æ³•çš„å‚æ•°ç±»å‹å’Œè¿”å›ç±»å‹ã€‚
5. ç»“åˆé™æ€æ–¹æ³• `LambdaMetafactory.metafactory` çš„ç¬¬äº”ä¸ªå‚æ•°ï¼ˆ`java/lang/invoke/MethodHandle`æ–¹æ³•å¥æŸ„ï¼‰å¯çŸ¥æœ€ç»ˆç»‘å®šåˆ°äº† `LambdaTest.lambda$main$0` æ–¹æ³•ï¼Œè¿™ä¹Ÿå°±æ˜¯ `Lambda` è¡¨è¾¾å¼æœ€ç»ˆåœ¨ `LambdaTest` ä¸­çš„ `main` æ–¹æ³•é‡Œç”Ÿæˆçš„ç§æœ‰æ–¹æ³•ã€‚
6. æœ€åï¼Œç”±äº `invokedynamic` æŒ‡ä»¤åœ¨ä¸€å¼€å§‹è°ƒç”¨äº†`showTestNumber`æ–¹æ³•ï¼Œæœ€ç»ˆå°†è¿”å›çš„`CallSite`å¯¹è±¡å­˜å‚¨åœ¨å±€éƒ¨å˜é‡è¡¨ä¸­ç­‰å¾…è°ƒç”¨ã€‚

é€šè¿‡è¿™ä¸ªè¿‡ç¨‹ï¼Œ`invokedynamic` æŒ‡ä»¤å®ç°äº†å¯¹ `LambdaTest` ç±»ä¸­ `showTestNumber` æ–¹æ³•çš„åŠ¨æ€è°ƒç”¨ã€‚
